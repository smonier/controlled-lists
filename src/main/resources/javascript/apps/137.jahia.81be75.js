(self.webpackChunkcontrolled_lists=self.webpackChunkcontrolled_lists||[]).push([[137],{1696:(e,t,r)=>{var a=r(5072),n=r(3983);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);a(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},3983:(e,t,r)=>{(t=r(6314)(!1)).push([e.id,"._1PQH6q0mtbs4crV1y6q9qy{display:flex;flex-direction:column;gap:16px}._1A05Oh_PN9Msb5g83hN8nL{display:flex;gap:24px;padding:24px;background:#fff;border-radius:8px;box-shadow:0 10px 30px rgba(20,46,110,.08)}._3cPq4N1KSjwiBOX1DkH9LO{width:280px;display:flex;flex-direction:column;gap:16px}._2VoRZmBKI4EuRCbW3mff0t{display:flex;flex-direction:column;gap:8px;max-height:500px;overflow-y:auto;padding-right:4px}._3VG3297pCbJuXKNadjRvkR{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border-radius:6px;border:1px solid #dfe4ef;background:#f9fbff;color:#2d3c5a;font-weight:500;cursor:pointer;transition:all .15s ease-in-out}._17nxPW6a6DUqYLMS9h14Yy{border-color:#2681ff;background:rgba(38,129,255,.1);color:#0c2c66}._3igPUo8BnUO_wc31tr_H-g{flex:1;display:flex;flex-direction:column;gap:16px}._3n6apRuumcI6wNujWpKraS{padding:20px;border-radius:8px;border:1px solid #e0e7ff;background:#fff;box-shadow:0 4px 14px rgba(21,34,50,.05)}._bFPawBurox5-NUlaWxIk{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;gap:12px}._1j-tnyn89SnwOC9kJMQ3Xp{display:flex;flex-direction:column;gap:6px;margin-bottom:14px}._38bw5B7WvGqDqaNaGaFX98{min-height:90px;padding:10px;border-radius:6px;border:1px solid #d7deef;font-size:14px;resize:vertical;font-family:inherit}.OwGuLXezbhuJW-eHPSsru{padding:12px 14px;border-radius:6px;font-weight:500}.p1DO0IJ-_-63KEQDSUYBj{background:#e5f5ed;color:#126235;border:1px solid rgba(18,98,53,.3)}._3zASdNW_fBcrOxlM7hNN1v{background:#fdeaea;color:#aa1b1b;border:1px solid rgba(170,27,27,.3)}._2_LZptxYoLLZx7nsqwkIMl{position:fixed;inset:0;background:rgba(12,23,41,.55);display:flex;align-items:center;justify-content:center;z-index:9999}._170FQmFmz_gcpGYls3WZG7{width:min(640px,90vw);background:#fff;border-radius:10px;box-shadow:0 25px 45px rgba(15,23,42,.25);display:flex;flex-direction:column;max-height:90vh}._1cyKmkaU_UXmsTbqVgYIcF{padding:20px;border-bottom:1px solid #ebf0ff;display:flex;flex-direction:column;gap:8px}._1Z2R9WLApLOduzmC6gFAQS{padding:20px;overflow-y:auto;display:flex;flex-direction:column;gap:16px}._190GCFfxfMwyVXivmvuxwo{display:flex;justify-content:flex-end;gap:12px;padding:16px 20px;border-top:1px solid #ebf0ff}.JSa-BSQOumNUnYWXn2BNy{display:none}._1hnPa4jhJqcc2iIzXRmDVz{width:100%;min-height:100px;border:1px solid #d7deef;border-radius:6px;padding:6px 8px;font-family:inherit}._2PnaNvl6mE4hCP74R4kpcN{border:1px solid #e0e7ff;border-radius:8px;padding:12px;background:#f7f9ff}._3AsUwzGPjymDzjKfzDN6xe{display:flex;flex-direction:column;gap:8px;margin-top:8px}._2HmD6UTeGiDaBBPm4gFm6U{display:flex;flex-direction:column;gap:2px;padding-bottom:8px;border-bottom:1px solid #dfe4ef}._2HmD6UTeGiDaBBPm4gFm6U:last-child{border-bottom:none;padding-bottom:0}._3xPZZe8d5acBeUGmuR1kdy{white-space:normal !important;word-break:break-word !important;white-space:normal;word-break:break-word}._3aRSOcDHAJnrC5ejCGpBBn{display:flex;align-items:center;gap:8px;cursor:pointer}._3TCfDCabL9C0aF__Gj5sQw{white-space:normal;word-break:break-word;line-height:1.4}.HNLsRvwmpjTKA0j1XnTal{display:flex;flex-wrap:wrap;gap:8px}._3EJmpupIpCnJIOULXhrarZ .moonstone-TableRow{min-height:72px !important;height:auto !important}._3EJmpupIpCnJIOULXhrarZ .moonstone-tableBodyCell{vertical-align:top !important;padding-top:12px !important;padding-bottom:12px !important;line-height:1.4;overflow:visible !important}._3EJmpupIpCnJIOULXhrarZ .moonstone-tableCellContent{overflow:visible !important;white-space:normal}.aPUOvBmsU7YlNMM2UR5DX{cursor:grab}._190P4pe4hDL9tGdKHez1TQ{cursor:default}._24-NPJ0XmStYfCPwrYCBTh{opacity:.5}._2sMm5P6Je6Fc7R52FPMzIK{pointer-events:none;height:64px;background:rgba(38,129,255,.08)}._2sMm5P6Je6Fc7R52FPMzIK td{padding:12px !important;border:2px dashed #2681ff !important}._1LnAJFLdBdIVPlcdHk9Jnm{height:100%}._3u2rFNMykvPolpekpzA0oV{height:24px}.kKsfJRXh3rGu8NXEYeMJm{display:flex;gap:8px;margin-bottom:16px}._36n29SKvu2sPZp3FlTFdl6{border:1px solid #dfe4ef;background:#f7f7fb;padding:6px 12px;border-radius:6px;cursor:pointer;transition:all .15s ease-in-out;display:flex;gap:6px;align-items:center}.GnpGvbo8as636bpOXCnUJ{background:rgba(38,129,255,.12);border-color:#2681ff;color:#0c2c66;font-weight:600}._22VH06o13uJx2wqDfRkjhB{font-size:16px}._2aCI0xfJ8awvT6F20WYCjq{display:inline-flex;align-items:center;gap:6px;font-weight:600}._3ls-z6Ob5PmXxsLLpIYRDD{padding:16px;border-radius:8px}._37TjsXi7Rzd2G5rcIJppC0{display:flex;flex-direction:column;gap:16px}._1NY17Ti4RX3L7GVRMkUKnc{display:flex;align-items:center;gap:12px}._2CnN5F_Xy-LKUU8Fqew7Aj{display:flex;flex-direction:column;gap:12px}._2GeCQKpF_y3RubogwhVqKN{display:flex;flex-direction:column;gap:8px;max-height:240px;overflow-y:auto;padding-right:4px}.kZFxvhRy9gzUJwwM9jvmS{display:flex;flex-direction:column;gap:8px}._1KQDYBSKhiDuHajyyBC1sq{display:flex;flex-wrap:wrap;gap:8px}",""]),t.locals={layout:"_1PQH6q0mtbs4crV1y6q9qy",container:"_1A05Oh_PN9Msb5g83hN8nL",listPanel:"_3cPq4N1KSjwiBOX1DkH9LO",listsContainer:"_2VoRZmBKI4EuRCbW3mff0t",listButton:"_3VG3297pCbJuXKNadjRvkR",listButtonActive:"_17nxPW6a6DUqYLMS9h14Yy",contentPanel:"_3igPUo8BnUO_wc31tr_H-g",card:"_3n6apRuumcI6wNujWpKraS",cardHeader:"_bFPawBurox5-NUlaWxIk",formGroup:"_1j-tnyn89SnwOC9kJMQ3Xp",textarea:"_38bw5B7WvGqDqaNaGaFX98",feedback:"OwGuLXezbhuJW-eHPSsru",feedbackSuccess:"p1DO0IJ-_-63KEQDSUYBj",feedbackError:"_3zASdNW_fBcrOxlM7hNN1v",dialogOverlay:"_2_LZptxYoLLZx7nsqwkIMl",dialog:"_170FQmFmz_gcpGYls3WZG7",dialogHeader:"_1cyKmkaU_UXmsTbqVgYIcF",dialogBody:"_1Z2R9WLApLOduzmC6gFAQS",dialogActions:"_190GCFfxfMwyVXivmvuxwo",hiddenInput:"JSa-BSQOumNUnYWXn2BNy",inlineTextarea:"_1hnPa4jhJqcc2iIzXRmDVz",previewBlock:"_2PnaNvl6mE4hCP74R4kpcN",previewList:"_3AsUwzGPjymDzjKfzDN6xe",previewItem:"_2HmD6UTeGiDaBBPm4gFm6U",descriptionCell:"_3xPZZe8d5acBeUGmuR1kdy",checkboxRow:"_3aRSOcDHAJnrC5ejCGpBBn",descriptionContent:"_3TCfDCabL9C0aF__Gj5sQw",termActions:"HNLsRvwmpjTKA0j1XnTal",termsTable:"_3EJmpupIpCnJIOULXhrarZ",termRow:"aPUOvBmsU7YlNMM2UR5DX",termRowDragDisabled:"_190P4pe4hDL9tGdKHez1TQ",draggingRow:"_24-NPJ0XmStYfCPwrYCBTh",placeholderRow:"_2sMm5P6Je6Fc7R52FPMzIK",placeholderBar:"_1LnAJFLdBdIVPlcdHk9Jnm",dropZoneRow:"_3u2rFNMykvPolpekpzA0oV",languageTabs:"kKsfJRXh3rGu8NXEYeMJm",languageTab:"_36n29SKvu2sPZp3FlTFdl6",languageTabActive:"GnpGvbo8as636bpOXCnUJ",languageFlag:"_22VH06o13uJx2wqDfRkjhB",languageBadge:"_2aCI0xfJ8awvT6F20WYCjq",selectorCard:"_3ls-z6Ob5PmXxsLLpIYRDD",selectorContainer:"_37TjsXi7Rzd2G5rcIJppC0",selectorLoading:"_1NY17Ti4RX3L7GVRMkUKnc",selectorTerms:"_2CnN5F_Xy-LKUU8Fqew7Aj",selectorTermsList:"_2GeCQKpF_y3RubogwhVqKN",selectorSelection:"kZFxvhRy9gzUJwwM9jvmS",selectorChips:"_1KQDYBSKhiDuHajyyBC1sq"},e.exports=t},5340:()=>{},9219:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ie});var a=r(3119),n=r(2816),i=r(7255),l=r(2207),o=r.n(l);const s="/controlled-lists";var u=r(8388),c=r(8557),d=r(3262),p=r.n(d),m=r(5066),g=r(2505),f=r.n(g),v=r(1658),h="\n    mutation DeleteControlledListNode($path: String!) {\n        jcr(workspace: EDIT) {\n            deleteNode(pathOrId: $path)\n        }\n    }\n",b='\n    mutation CreateControlledTerm($parentPath: String!, $name: String!, $properties: [InputJCRProperty]!) {\n        jcr(workspace: EDIT) {\n            addNode(\n                parentPathOrId: $parentPath\n                name: $name\n                primaryNodeType: "cl:controlledTerm"\n                properties: $properties\n            ) {\n                uuid\n            }\n        }\n    }\n',y="\n    mutation UpdateControlledTerm($path: String!, $properties: [InputJCRProperty]!) {\n        jcr(workspace: EDIT) {\n            mutateNode(pathOrId: $path) {\n                setPropertiesBatch(properties: $properties) {\n                    property {\n                        name\n                    }\n                }\n                uuid\n            }\n        }\n    }\n",x=r(1696),w=r.n(x),E=r(5556),C=r.n(E),N=r(9383),T=r.n(N),S=r(4199),k=r.n(S),L=function(e){return(e||[]).map(function(e){return{value:(e.value||"").trim(),label:(e.label||e.value||"").trim(),description:(e.description||"").trim()}}).filter(function(e){return e.value&&e.label})},I=function(e,t){var r;return t&&e.some(function(e){return e.code===t})?t:(null===(r=e[0])||void 0===r?void 0:r.code)||""},A=function(e){var t=e.isOpen,r=e.siteLanguages,a=e.initialLanguage,n=e.onClose,l=e.onImport,o=e.t,s=(0,d.useState)([]),u=(0,i.A)(s,2),c=u[0],g=u[1],f=(0,d.useState)(""),v=(0,i.A)(f,2),h=v[0],b=v[1],y=(0,d.useState)(null),x=(0,i.A)(y,2),E=x[0],C=x[1],N=(0,d.useState)(!1),S=(0,i.A)(N,2),A=S[0],P=S[1],B=(0,d.useState)(function(){return I(r,a)}),R=(0,i.A)(B,2),_=R[0],D=R[1],F=(0,d.useState)(!1),O=(0,i.A)(F,2),z=O[0],j=O[1],J=(0,d.useRef)(null),U=(0,d.useMemo)(function(){return(r||[]).map(function(e){return{label:e.displayName||e.code,value:e.code}})},[r]),q=(0,d.useCallback)(function(){g([]),b(""),C(null),P(!1),D(I(r,a)),j(!1)},[a,r]);return(0,d.useEffect)(function(){t||q()},[t,q]),(0,d.useEffect)(function(){D(function(e){return e&&r.some(function(t){return t.code===e})?e:I(r,a)})},[a,r]),t?T().createPortal(p().createElement("div",{className:w().dialogOverlay},p().createElement("div",{className:w().dialog},p().createElement("div",{className:w().dialogHeader},p().createElement(m.Typography,{variant:"heading"},o("import.title")),p().createElement(m.Typography,{variant:"body"},o("import.instructions"))),p().createElement("div",{className:w().dialogBody},p().createElement("div",{className:w().formGroup},p().createElement(m.Button,{size:"big",label:h||o("import.selectFile"),onClick:function(){var e;return null===(e=J.current)||void 0===e?void 0:e.click()}}),p().createElement("input",{ref:J,type:"file",accept:".csv,.json",className:w().hiddenInput,onChange:function(e){var t=e.target.files[0];if(t)if(P(!0),C(null),b(t.name),"json"===t.name.toLowerCase().split(".").pop()){var r=new FileReader;r.onload=function(e){try{var t=JSON.parse(e.target.result||"[]"),r=L(Array.isArray(t)?t:[]);if(!r.length)throw new Error(o("import.errors.invalidFormat"));g(r)}catch(e){g([]),C(e.message||o("import.errors.invalidFormat"))}finally{P(!1)}},r.onerror=function(){P(!1),C(o("import.errors.readFailed"))},r.readAsText(t)}else k().parse(t,{header:!0,skipEmptyLines:!0,complete:function(e){var t;if(null!=e&&null!==(t=e.errors)&&void 0!==t&&t.length)C(e.errors[0].message||o("import.errors.invalidFormat")),g([]);else{var r=L(e.data);0===r.length?C(o("import.errors.invalidFormat")):g(r)}P(!1)},error:function(e){g([]),P(!1),C(e.message||o("import.errors.invalidFormat"))}})}}),p().createElement(m.Typography,{variant:"caption"},o("import.supportedFormats"))),A&&p().createElement(m.Typography,{variant:"body"},o("import.parsing")),E&&p().createElement("div",{className:"".concat(w().feedback," ").concat(w().feedbackError)},E),Boolean(c.length)&&p().createElement("div",{className:w().previewBlock},p().createElement(m.Typography,{variant:"subheading"},o("import.preview",{count:c.length})),p().createElement("div",{className:w().previewList},c.slice(0,5).map(function(e){var t="".concat(e.value,"-").concat(e.label,"-").concat(e.description);return p().createElement("div",{key:t,className:w().previewItem},p().createElement("strong",null,e.value),p().createElement("span",null,e.label),e.description&&p().createElement("em",null,e.description))}),c.length>5&&p().createElement(m.Typography,{variant:"caption"},o("import.moreRows",{count:c.length-5})))),p().createElement("div",{className:w().formGroup},p().createElement(m.Typography,{variant:"body",weight:"bold"},o("import.language")),p().createElement(m.Dropdown,{data:U,value:_,placeholder:o("import.language"),onChange:function(e,t){return D(t.value)}})),p().createElement("div",{className:w().formGroup},p().createElement("label",{className:w().checkboxRow},p().createElement(m.Checkbox,{checked:z,onChange:function(e,t,r){return j(r)}}),p().createElement(m.Typography,{variant:"body"},o("import.override"))))),p().createElement("div",{className:w().dialogActions},p().createElement(m.Button,{size:"big",label:o("actions.cancel"),onClick:function(){n()}}),p().createElement(m.Button,{size:"big",color:"accent",isDisabled:!c.length||A,label:o("import.importButton"),onClick:function(){_?l(c,{language:_,overrideExisting:z}):C(o("import.errors.noLanguage"))}})))),document.body):null};A.propTypes={isOpen:C().bool.isRequired,siteLanguages:C().arrayOf(C().shape({code:C().string.isRequired,displayName:C().string})),initialLanguage:C().string,onClose:C().func.isRequired,onImport:C().func.isRequired,t:C().func.isRequired},A.defaultProps={siteLanguages:[],initialLanguage:""};var P={en:"ğŸ‡¬ğŸ‡§",fr:"ğŸ‡«ğŸ‡·",de:"ğŸ‡©ğŸ‡ª",es:"ğŸ‡ªğŸ‡¸",it:"ğŸ‡®ğŸ‡¹",pt:"ğŸ‡µğŸ‡¹",nl:"ğŸ‡³ğŸ‡±",ru:"ğŸ‡·ğŸ‡º",ja:"ğŸ‡¯ğŸ‡µ",zh:"ğŸ‡¨ğŸ‡³",ar:"ğŸ‡¸ğŸ‡¦",ko:"ğŸ‡°ğŸ‡·",pl:"ğŸ‡µğŸ‡±",tr:"ğŸ‡¹ğŸ‡·",sv:"ğŸ‡¸ğŸ‡ª",da:"ğŸ‡©ğŸ‡°",no:"ğŸ‡³ğŸ‡´",fi:"ğŸ‡«ğŸ‡®",cs:"ğŸ‡¨ğŸ‡¿",el:"ğŸ‡¬ğŸ‡·"},B=function(e){return P[e]||"ğŸŒ"},R=function(e){var t=e.isOpen,r=e.form,a=e.onChange,n=e.onClose,i=e.onSave,l=e.isSaving,o=e.t,s=e.languageCode,u=e.languageName;return t?T().createPortal(p().createElement("div",{className:w().dialogOverlay},p().createElement("div",{className:w().dialog},p().createElement("div",{className:w().dialogHeader},p().createElement(m.Typography,{variant:"heading"},o("edit.title")),s&&p().createElement(m.Typography,{variant:"body",className:w().languageBadge},B(s)," ",u||s.toUpperCase())),p().createElement("div",{className:w().dialogBody},p().createElement("div",{className:w().formGroup},p().createElement(m.Typography,{variant:"body",weight:"bold"},o("terms.fields.value")),p().createElement(m.Input,{value:r.value,onChange:function(e){return a("value",e.target.value)}})),p().createElement("div",{className:w().formGroup},p().createElement(m.Typography,{variant:"body",weight:"bold"},o("terms.fields.label")),p().createElement(m.Input,{value:r.label,onChange:function(e){return a("label",e.target.value)}})),p().createElement("div",{className:w().formGroup},p().createElement(m.Typography,{variant:"body",weight:"bold"},o("terms.fields.description")),p().createElement("textarea",{className:w().inlineTextarea,value:r.description,onChange:function(e){return a("description",e.target.value)}}))),p().createElement("div",{className:w().dialogActions},p().createElement(m.Button,{size:"big",label:o("actions.cancel"),onClick:n}),p().createElement(m.Button,{size:"big",color:"accent",isDisabled:l,label:o("actions.save"),onClick:i})))),document.body):null};function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach(function(t){(0,u.A)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}R.propTypes={isOpen:C().bool.isRequired,form:C().shape({value:C().string,label:C().string,description:C().string}).isRequired,onChange:C().func.isRequired,onClose:C().func.isRequired,onSave:C().func.isRequired,isSaving:C().bool,t:C().func.isRequired,languageCode:C().string,languageName:C().string};var F={uuid:null,path:"",systemName:"",title:"",description:""},O={uuid:null,path:"",value:"",label:"",description:""},z=function(e,t,r){var a=function(e){return e.toString().normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[^\w\s-]/g,"").trim().replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"").toLowerCase()}(e)||r;if(!t.includes(a))return a;for(var n=1;t.includes("".concat(a,"-").concat(n));)n+=1;return"".concat(a,"-").concat(n)},j=function(e){return window.confirm(e)},J=function(e,t,r){if(!Array.isArray(e)||e.length<2)return null;if(null==t||null==r||t<0||t>=e.length)return null;var a=Math.max(0,Math.min(r,e.length)),n=(0,c.A)(e),l=n.splice(t,1),o=(0,i.A)(l,1)[0];if(!o)return null;var s=t<a?a-1:a;return n.splice(s,0,o),n.length===e.length&&n.every(function(t,r){return t.uuid===e[r].uuid})?null:n},U=function(e){var t,r,a;return{uuid:e.uuid,path:e.path,name:e.name,systemName:e.name,title:(null===(t=e.title)||void 0===t?void 0:t.value)||e.name,description:(null===(r=e.description)||void 0===r?void 0:r.value)||"",terms:((null===(a=e.children)||void 0===a?void 0:a.nodes)||[]).map(function(e){var t,r,a;return{uuid:e.uuid,path:e.path,name:e.name,value:(null===(t=e.termValue)||void 0===t?void 0:t.value)||"",label:(null===(r=e.termLabel)||void 0===r?void 0:r.value)||"",description:(null===(a=e.termDescription)||void 0===a?void 0:a.value)||""}})}},q=function(e){if(!Array.isArray(e))return[];var t=new Set,r=[];return e.forEach(function(e){if(e){var a=e.code;a&&!t.has(a)&&(r.push({code:a,displayName:e.displayName||a}),t.add(a))}}),r},V=function(){var e,t,r,a=(0,v.useTranslation)("controlled-lists"),l=a.t,s=a.i18n.language,g=window.contextJsParameters||{},x=g.siteKey||(null===(e=g.site)||void 0===e?void 0:e.key)||"",E=(null===(t=g.site)||void 0===t?void 0:t.displayName)||(null===(r=g.site)||void 0===r?void 0:r.name)||x||"",C=(0,d.useState)(s||"en"),N=(0,i.A)(C,2),T=N[0],S=N[1],k="".concat(g.contextPath||"","/modules/graphql"),L=q((g.siteLanguages||[]).map(function(e){return"string"==typeof e?{code:e,displayName:e}:{code:e.language||e.code,displayName:e.displayName||e.language||e.code}}).filter(function(e){return e.code})),I=(0,d.useState)(L),P=(0,i.A)(I,2),_=P[0],V=P[1],M=(0,d.useState)(""),G=(0,i.A)(M,2),$=G[0],K=G[1],X=(0,d.useState)([]),H=(0,i.A)(X,2),Y=H[0],Z=H[1],W=(0,d.useState)(null),Q=(0,i.A)(W,2),ee=Q[0],te=Q[1],re=(0,d.useState)(!1),ae=(0,i.A)(re,2),ne=ae[0],ie=ae[1],le=(0,d.useState)(F),oe=(0,i.A)(le,2),se=oe[0],ue=oe[1],ce=(0,d.useState)(O),de=(0,i.A)(ce,2),pe=de[0],me=de[1],ge=(0,d.useState)(!1),fe=(0,i.A)(ge,2),ve=fe[0],he=fe[1],be=(0,d.useState)(!1),ye=(0,i.A)(be,2),xe=ye[0],we=ye[1],Ee=(0,d.useState)(!1),Ce=(0,i.A)(Ee,2),Ne=Ce[0],Te=Ce[1],Se=(0,d.useState)(null),ke=(0,i.A)(Se,2),Le=ke[0],Ie=ke[1],Ae=(0,d.useState)(null),Pe=(0,i.A)(Ae,2),Be=Pe[0],Re=Pe[1],_e=(0,d.useState)(!1),De=(0,i.A)(_e,2),Fe=De[0],Oe=De[1],ze=(0,d.useState)(!1),je=(0,i.A)(ze,2),Je=je[0],Ue=je[1],qe=(0,d.useState)(!1),Ve=(0,i.A)(qe,2),Me=Ve[0],Ge=Ve[1],$e=(0,d.useState)(O),Ke=(0,i.A)($e,2),Xe=Ke[0],He=Ke[1],Ye=(0,d.useState)(!1),Ze=(0,i.A)(Ye,2),We=Ze[0],Qe=Ze[1],et=(0,d.useState)({sourceIndex:null,targetIndex:null}),tt=(0,i.A)(et,2),rt=tt[0],at=tt[1];(0,d.useEffect)(function(){S(s||"en")},[s]);var nt=(0,d.useCallback)(function(){var e=(0,n.A)(o().mark(function e(t,r){var a,n,i;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,f().post(k,{query:t,variables:r},{headers:{"Content-Type":"application/json"},withCredentials:!0});case 1:if(n=e.sent,null===(a=n.data)||void 0===a||null===(a=a.errors)||void 0===a||!a.length){e.next=2;break}throw i=n.data.errors.map(function(e){return e.message}).join("\n"),new Error(i);case 2:return e.abrupt("return",n.data.data);case 3:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}(),[k]),it=(0,d.useMemo)(function(){return Y.find(function(e){return e.uuid===ee})||null},[Y,ee]),lt=(0,d.useCallback)(function(){at({sourceIndex:null,targetIndex:null})},[]);(0,d.useEffect)(function(){lt(),Qe(!1)},[lt,ee,ne]),(0,d.useEffect)(function(){$&&st($)},[T,st,$]),(0,d.useEffect)(function(){if(Le){var e=setTimeout(function(){return Ie(null)},5e3);return function(){return clearTimeout(e)}}},[Le]);var ot=(0,d.useCallback)((0,n.A)(o().mark(function e(){var t,r,a,n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(x){e.next=1;break}throw new Error(l("errors.missingSite"));case 1:return r="/sites/".concat(x,"/contents"),a="".concat(r,"/controlled-lists"),e.next=2,nt("\n    query ControlledListsRoot($path: String!) {\n        jcr {\n            nodeByPath(path: $path) {\n                uuid\n                path\n            }\n        }\n    }\n",{path:a});case 2:if(null!=(n=e.sent)&&null!==(t=n.jcr)&&void 0!==t&&t.nodeByPath){e.next=3;break}return e.next=3,nt('\n    mutation CreateControlledListsRoot($parentPath: String!) {\n        jcr(workspace: EDIT) {\n            addNode(\n                parentPathOrId: $parentPath\n                name: "controlled-lists"\n                primaryNodeType: "cl:listsFolder"\n            ) {\n                uuid\n            }\n        }\n    }\n',{parentPath:r});case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}},e)})),[nt,x,l]),st=(0,d.useCallback)(function(){var e=(0,n.A)(o().mark(function e(t,r){var a,n,i,l,s;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=1;break}return e.abrupt("return");case 1:return he(!0),Re(null),e.prev=2,e.next=3,nt('\n    query ControlledLists($rootPath: String!, $language: String!) {\n        jcr {\n            nodeByPath(path: $rootPath) {\n                uuid\n                path\n                children(typesFilter: {types: ["cl:controlledList"]}) {\n                    nodes {\n                        uuid\n                        path\n                        name\n                        title: property(name: "jcr:title", language: $language) {\n                            value\n                        }\n                        description: property(name: "cl:description", language: $language) {\n                            value\n                        }\n                        children(typesFilter: {types: ["cl:controlledTerm"]}) {\n                            nodes {\n                                uuid\n                                path\n                                name\n                                termValue: property(name: "cl:value") {\n                                    value\n                                }\n                                termLabel: property(name: "cl:label", language: $language) {\n                                    value\n                                }\n                                termDescription: property(name: "cl:description", language: $language) {\n                                    value\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n',{rootPath:t,language:T});case 3:n=e.sent,(i=((null==n||null===(a=n.jcr)||void 0===a||null===(a=a.nodeByPath)||void 0===a||null===(a=a.children)||void 0===a?void 0:a.nodes)||[]).map(U)).sort(function(e,t){return e.title.localeCompare(t.title,T,{sensitivity:"base"})}),Z(i),r?(te(r),ie(!1)):ne||i.some(function(e){return e.uuid===ee})||te((null===(l=i[0])||void 0===l?void 0:l.uuid)||null),e.next=5;break;case 4:e.prev=4,s=e.catch(2),Re(s);case 5:return e.prev=5,he(!1),e.finish(5);case 6:case"end":return e.stop()}},e,null,[[2,4,5,6]])}));return function(t,r){return e.apply(this,arguments)}}(),[nt,T,ee,ne]);(0,d.useEffect)(function(){var e=!0,t=function(){var t=(0,n.A)(o().mark(function t(){var r,a;return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(x){t.next=1;break}return Re(new Error(l("errors.missingSite"))),t.abrupt("return");case 1:return t.prev=1,t.next=2,ot();case 2:if(r=t.sent,e){t.next=3;break}return t.abrupt("return");case 3:return K(r),t.next=4,st(r);case 4:t.next=6;break;case 5:t.prev=5,a=t.catch(1),e&&Re(a);case 6:case"end":return t.stop()}},t,null,[[1,5]])}));return function(){return t.apply(this,arguments)}}();return t(),function(){e=!1}},[ot,st,x,l]),(0,d.useEffect)(function(){if(x){var e=!0,t=function(){var t=(0,n.A)(o().mark(function t(){var r,a,n,i,l,s;return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=1,nt("\n    query ControlledListLanguages($sitePath: String!) {\n        jcr {\n            nodeByPath(path: $sitePath) {\n                site {\n                    languages {\n                        displayName\n                        language\n                        activeInEdit\n                    }\n                }\n            }\n        }\n    }\n",{sitePath:"/sites/".concat(x)});case 1:n=t.sent,i=null!==(r=null==n||null===(a=n.jcr)||void 0===a||null===(a=a.nodeByPath)||void 0===a||null===(a=a.site)||void 0===a||null===(a=a.languages)||void 0===a?void 0:a.filter(function(e){return e.activeInEdit}))&&void 0!==r?r:[],e&&i.length&&(l=q(i.map(function(e){return{code:e.language,displayName:e.displayName||e.language}})),V(l),!l.find(function(e){return e.code===T})&&l[0]&&S(l[0].code)),t.next=3;break;case 2:t.prev=2,s=t.catch(0),console.warn("Failed to load site languages",s);case 3:case"end":return t.stop()}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}();return t(),function(){e=!1}}V([])},[nt,T,x]),(0,d.useEffect)(function(){ue(ne?D({},F):it?{uuid:it.uuid,path:it.path,systemName:it.systemName,title:it.title,description:it.description}:D({},F)),me(D({},O)),Ge(!1)},[it,ne,T]);var ut=function(e,t){ue(function(r){return D(D({},r),{},(0,u.A)({},e,t))})},ct=function(e,t){me(function(r){return D(D({},r),{},(0,u.A)({},e,t))})},dt=function(e,t,r){Ie({type:e,message:l(t,r)})},pt=function(){var e=(0,n.A)(o().mark(function e(t){var r,a,n,i,s,u,c,d,p,m;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),$){e.next=1;break}return e.abrupt("return");case 1:if(r=se.systemName.trim(),a=se.title.trim(),n=se.description.trim(),r&&a){e.next=2;break}return Ie({type:"error",message:l("errors.requiredFields")}),e.abrupt("return");case 2:if(!Y.some(function(e){return e.uuid!==se.uuid&&e.systemName.toLowerCase()===r.toLowerCase()})){e.next=3;break}return Ie({type:"error",message:l("errors.duplicateSystemName",{name:r})}),e.abrupt("return");case 3:if(i=[{name:"jcr:title",value:a,language:T},{name:"cl:description",value:n||"",language:T}],we(!0),e.prev=4,!ne){e.next=7;break}return u=Y.map(function(e){return e.name}),c=z(r,u,"controlled-list"),e.next=5,nt('\n    mutation CreateControlledList($parentPath: String!, $name: String!, $properties: [InputJCRProperty]!) {\n        jcr(workspace: EDIT) {\n            addNode(\n                parentPathOrId: $parentPath\n                name: $name\n                primaryNodeType: "cl:controlledList"\n                properties: $properties\n            ) {\n                uuid\n            }\n        }\n    }\n',{parentPath:$,name:c,properties:i});case 5:return d=e.sent,p=(null==d||null===(s=d.jcr)||void 0===s||null===(s=s.addNode)||void 0===s?void 0:s.uuid)||null,dt("success","feedback.listCreated"),ie(!1),e.next=6,st($,p);case 6:e.next=10;break;case 7:if(!it){e.next=10;break}return e.next=8,nt("\n    mutation UpdateControlledList($path: String!, $properties: [InputJCRProperty]!) {\n        jcr(workspace: EDIT) {\n            mutateNode(pathOrId: $path) {\n                setPropertiesBatch(properties: $properties) {\n                    property {\n                        name\n                    }\n                }\n                uuid\n            }\n        }\n    }\n",{path:it.path,properties:i});case 8:if(it.systemName===r){e.next=9;break}return e.next=9,nt("\n    mutation RenameControlledList($path: String!, $name: String!) {\n        jcr(workspace: EDIT) {\n            mutateNode(pathOrId: $path) {\n                rename(name: $name)\n            }\n        }\n    }\n",{path:it.path,name:r});case 9:return dt("success","feedback.listUpdated"),e.next=10,st($,it.uuid);case 10:e.next=12;break;case 11:e.prev=11,m=e.catch(4),Ie({type:"error",message:m.message});case 12:return e.prev=12,we(!1),e.finish(12);case 13:case"end":return e.stop()}},e,null,[[4,11,12,13]])}));return function(t){return e.apply(this,arguments)}}(),mt=function(){var e=(0,n.A)(o().mark(function e(t){var r;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if($&&t){e.next=1;break}return e.abrupt("return");case 1:if(j(l("lists.deleteConfirm",{title:t.title}))){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=3,nt(h,{path:t.path});case 3:return dt("success","feedback.listDeleted"),e.next=4,st($);case 4:e.next=6;break;case 5:e.prev=5,r=e.catch(2),Ie({type:"error",message:r.message});case 6:case"end":return e.stop()}},e,null,[[2,5]])}));return function(t){return e.apply(this,arguments)}}(),gt=function(){var e=(0,n.A)(o().mark(function e(t){var r,a,n,i,s,u,c;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),it){e.next=1;break}return e.abrupt("return");case 1:if(r=pe.value.trim(),a=pe.label.trim(),n=pe.description.trim(),r&&a){e.next=2;break}return Ie({type:"error",message:l("errors.requiredFields")}),e.abrupt("return");case 2:if(!it.terms.some(function(e){return e.uuid!==pe.uuid&&e.value.toLowerCase()===r.toLowerCase()})){e.next=3;break}return Ie({type:"error",message:l("errors.duplicateTermValue",{value:r})}),e.abrupt("return");case 3:if(i=[{name:"cl:value",value:r},{name:"cl:label",value:a,language:T},{name:"cl:description",value:n||"",language:T}],Te(!0),e.prev=4,!pe.uuid){e.next=6;break}return e.next=5,nt(y,{path:pe.path,properties:i});case 5:dt("success","feedback.termUpdated"),e.next=8;break;case 6:return s=it.terms.map(function(e){return e.name}),u=z(r,s,"controlled-term"),e.next=7,nt(b,{parentPath:it.path,name:u,properties:i});case 7:dt("success","feedback.termCreated");case 8:return me(D({},O)),e.next=9,st($,it.uuid);case 9:e.next=11;break;case 10:e.prev=10,c=e.catch(4),Ie({type:"error",message:c.message});case 11:return e.prev=11,Te(!1),e.finish(11);case 12:case"end":return e.stop()}},e,null,[[4,10,11,12]])}));return function(t){return e.apply(this,arguments)}}(),ft=function(){var e=(0,n.A)(o().mark(function e(){var t,r,a,n,i;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(it){e.next=1;break}return e.abrupt("return");case 1:if(t=Xe.value.trim(),r=Xe.label.trim(),a=Xe.description.trim(),t&&r){e.next=2;break}return Ie({type:"error",message:l("errors.requiredFields")}),e.abrupt("return");case 2:if(!it.terms.some(function(e){return e.uuid!==Xe.uuid&&e.value.toLowerCase()===t.toLowerCase()})){e.next=3;break}return Ie({type:"error",message:l("errors.duplicateTermValue",{value:t})}),e.abrupt("return");case 3:return n=[{name:"cl:value",value:t},{name:"cl:label",value:r,language:T},{name:"cl:description",value:a||"",language:T}],Te(!0),e.prev=4,e.next=5,nt(y,{path:Xe.path,properties:n});case 5:return dt("success","feedback.termUpdated"),Ge(!1),e.next=6,st($,it.uuid);case 6:e.next=8;break;case 7:e.prev=7,i=e.catch(4),Ie({type:"error",message:i.message});case 8:return e.prev=8,Te(!1),e.finish(8);case 9:case"end":return e.stop()}},e,null,[[4,7,8,9]])}));return function(){return e.apply(this,arguments)}}(),vt=function(){var e=(0,n.A)(o().mark(function e(t){var r;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(it&&t){e.next=1;break}return e.abrupt("return");case 1:if(j(l("terms.deleteConfirm",{label:t.label||t.value}))){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,Me&&Xe.uuid===t.uuid&&Ge(!1),e.next=3,nt(h,{path:t.path});case 3:return dt("success","feedback.termDeleted"),e.next=4,st($,it.uuid);case 4:e.next=6;break;case 5:e.prev=5,r=e.catch(2),Ie({type:"error",message:r.message});case 6:case"end":return e.stop()}},e,null,[[2,5]])}));return function(t){return e.apply(this,arguments)}}(),ht=function(){var e=(0,n.A)(o().mark(function e(t){var r,a,n,i,s,u,d,p,m,g,f,v,h,x=arguments;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=x.length>1&&void 0!==x[1]?x[1]:{},it){e.next=1;break}return Ie({type:"error",message:l("import.errors.noList")}),e.abrupt("return");case 1:if(Ge(!1),Ue(!0),e.prev=2,a=new Set(it.terms.map(function(e){return e.name})),n=new Map(it.terms.map(function(e){return[e.value.toLowerCase(),e]})),i=[],s=[],u=r.language||T,d=Boolean(r.overrideExisting),t.forEach(function(e){var t,r,l,o=null===(t=e.value)||void 0===t?void 0:t.trim(),c=null===(r=e.label)||void 0===r?void 0:r.trim();if(o&&c){var p=o.toLowerCase(),m=(null===(l=e.description)||void 0===l?void 0:l.trim())||"",g=[{name:"cl:value",value:o},{name:"cl:label",value:c,language:u},{name:"cl:description",value:m,language:u}],f=n.get(p);if(f)d&&s.push({path:f.path,properties:g});else{var v=z(o,Array.from(a),"controlled-term");a.add(v),n.set(p,{path:null}),i.push({name:v,properties:g})}}}),i.length||s.length){e.next=3;break}return Ie({type:"error",message:l("import.errors.noValidRows")}),e.abrupt("return");case 3:return e.next=4,Promise.allSettled(i.map(function(e){return nt(b,{parentPath:it.path,name:e.name,properties:e.properties})}));case 4:return p=e.sent,e.next=5,Promise.allSettled(s.map(function(e){return nt(y,{path:e.path,properties:e.properties})}));case 5:if(m=e.sent,g=p.filter(function(e){return"fulfilled"===e.status}).length,f=m.filter(function(e){return"fulfilled"===e.status}).length,v=[].concat((0,c.A)(p),(0,c.A)(m)).find(function(e){return"rejected"===e.status}),!(g+f>0)){e.next=6;break}return Oe(!1),dt("success","feedback.termImported",{count:g+f}),e.next=6,st($,it.uuid);case 6:if(!v){e.next=7;break}throw v.reason;case 7:e.next=9;break;case 8:e.prev=8,h=e.catch(2),Ie({type:"error",message:h.message});case 9:return e.prev=9,Ue(!1),e.finish(9);case 10:case"end":return e.stop()}},e,null,[[2,8,9,10]])}));return function(t){return e.apply(this,arguments)}}(),bt=(0,d.useCallback)(function(e){at(function(t){if(null===t.sourceIndex)return t;var r=(null==it?void 0:it.terms.length)||0,a=Math.max(0,Math.min(e,r));return a===t.targetIndex?t:D(D({},t),{},{targetIndex:a})})},[it]),yt=function(){var e=(0,n.A)(o().mark(function e(t){var r,a,n,i;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==rt.sourceIndex&&null!==rt.targetIndex&&it){e.next=1;break}return lt(),e.abrupt("return");case 1:if(t.preventDefault(),t.stopPropagation(),r=rt.sourceIndex,a=rt.targetIndex,n=J(it.terms,r,a),lt(),n){e.next=2;break}return e.abrupt("return");case 2:return Qe(!0),e.prev=3,e.next=4,nt("\n    mutation ReorderControlledTerms($path: String!, $names: [String]!) {\n        jcr(workspace: EDIT) {\n            mutateNode(pathOrId: $path) {\n                reorderChildren(names: $names)\n            }\n        }\n    }\n",{path:it.path,names:n.map(function(e){return e.name})});case 4:return dt("success","feedback.termReordered"),e.next=5,st($,it.uuid);case 5:e.next=7;break;case 6:e.prev=6,i=e.catch(3),Ie({type:"error",message:i.message});case 7:return e.prev=7,Qe(!1),e.finish(7);case 8:case"end":return e.stop()}},e,null,[[3,6,7,8]])}));return function(t){return e.apply(this,arguments)}}(),xt=function(){We||lt()},wt=_.find(function(e){return e.code===T});return p().createElement(p().Fragment,null,p().createElement(m.LayoutContent,{header:p().createElement(m.Header,{title:"".concat(l("pageTitle")).concat(E?" - ".concat(E):""),subtitle:l("pageSubtitle"),mainActions:[p().createElement(m.Button,{key:"create-list",color:"accent",size:"big",label:l("actions.createList"),onClick:function(){ie(!0),te(null),ue(D({},F)),me(D({},O)),lt()}})]}),content:p().createElement("div",{className:w().layout},Le&&p().createElement("div",{className:"".concat(w().feedback," ").concat("error"===Le.type?w().feedbackError:w().feedbackSuccess)},Le.message),Be&&p().createElement("div",{className:"".concat(w().feedback," ").concat(w().feedbackError)},Be.message),p().createElement("div",{className:w().container},p().createElement("div",{className:w().listPanel},p().createElement(m.Typography,{variant:"heading"},l("lists.title")),p().createElement("div",{className:w().listsContainer},0===Y.length&&!ve&&p().createElement(m.Typography,{variant:"body"},l("lists.empty")),Y.map(function(e){return p().createElement("button",{key:e.uuid,type:"button",className:"".concat(w().listButton," ").concat(e.uuid!==ee||ne?"":w().listButtonActive),onClick:function(){te(e.uuid),ie(!1)}},p().createElement("span",null,e.title))})),p().createElement(m.Button,{size:"big",label:l("actions.reload"),onClick:function(){return st($)}})),p().createElement("div",{className:w().contentPanel},ve&&p().createElement(m.Typography,{variant:"body"},l("states.loading")),!ve&&(Y.length>0||ne)&&p().createElement(p().Fragment,null,_.length?p().createElement("div",{className:w().languageTabs},_.map(function(e){return p().createElement("button",{key:e.code,type:"button",className:"".concat(w().languageTab," ").concat(e.code===T?w().languageTabActive:""),onClick:function(){var t;(t=e.code)&&t!==T&&S(t)}},p().createElement("span",{className:w().languageFlag},B(e.code)),p().createElement("span",null,e.displayName||e.code))})):null,p().createElement(m.Paper,{className:w().card},p().createElement(m.Typography,{variant:"heading"},l(ne?"lists.createTitle":"lists.editTitle")),p().createElement("form",{onSubmit:pt},p().createElement("div",{className:w().formGroup},p().createElement(m.Typography,{variant:"body",weight:"bold"},l("lists.fields.systemName")),p().createElement(m.Input,{value:se.systemName,onChange:function(e){return ut("systemName",e.target.value)}}),p().createElement(m.Typography,{variant:"caption"},l("lists.help.systemName"))),p().createElement("div",{className:w().formGroup},p().createElement(m.Typography,{variant:"body",weight:"bold"},l("lists.fields.title")),p().createElement(m.Input,{value:se.title,onChange:function(e){return ut("title",e.target.value)}})),p().createElement("div",{className:w().formGroup},p().createElement(m.Typography,{variant:"body",weight:"bold"},l("lists.fields.description")),p().createElement("textarea",{className:w().textarea,value:se.description,onChange:function(e){return ut("description",e.target.value)}})),p().createElement("div",{style:{display:"flex",gap:"12px"}},p().createElement(m.Button,{type:"submit",size:"big",disabled:xe,label:l("actions.save")}),!ne&&p().createElement(m.Button,{type:"button",size:"big",color:"danger",label:l("actions.delete"),onClick:function(){return mt(it)}})))),!it||ne?null:p().createElement(m.Paper,{className:w().card},p().createElement("div",{className:w().cardHeader},p().createElement(m.Typography,{variant:"heading"},l("terms.title")),p().createElement(m.Button,{size:"big",color:"accent",isDisabled:Je,label:l("actions.importTerms"),onClick:function(){return Oe(!0)}})),p().createElement("div",{style:{overflowX:"auto",marginTop:"12px"}},p().createElement(m.Table,{className:w().termsTable},p().createElement(m.TableHead,null,p().createElement(m.TableRow,null,p().createElement(m.TableHeadCell,null,l("terms.fields.value")),p().createElement(m.TableHeadCell,null,l("terms.fields.label")),p().createElement(m.TableHeadCell,null,l("terms.fields.description")),p().createElement(m.TableHeadCell,null,l("actions.actionsColumn")))),p().createElement(m.TableBody,{onDrop:yt},function(){if(!it||0===it.terms.length)return p().createElement(m.TableRow,null,p().createElement(m.TableBodyCell,{colSpan:4},l("terms.empty")));var e=it.terms.length>1&&!We,t=null!==rt.sourceIndex&&null!==rt.targetIndex&&(rt.targetIndex===rt.sourceIndex||rt.targetIndex===rt.sourceIndex+1&&rt.targetIndex>rt.sourceIndex),r=null===rt.sourceIndex||null===rt.targetIndex||t?null:rt.targetIndex,a=function(e){return p().createElement(m.TableRow,{key:"placeholder-".concat(e),className:w().placeholderRow},p().createElement(m.TableBodyCell,{colSpan:4},p().createElement("div",{className:w().placeholderBar})))},n=[];return it.terms.forEach(function(t,i){r===i&&n.push(a("before-".concat(t.uuid)));var o=[w().termRow];rt.sourceIndex===i&&o.push(w().draggingRow),e||o.push(w().termRowDragDisabled),n.push(p().createElement(m.TableRow,{key:t.uuid,className:o.join(" "),draggable:e,onDragStart:function(e){return function(e,t){!it||it.terms.length<2||We||(e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",it.terms[t].uuid)),at({sourceIndex:t,targetIndex:t}))}(e,i)},onDragOver:function(e){return function(e,t){if(null!==rt.sourceIndex){e.preventDefault();var r=e.currentTarget.getBoundingClientRect(),a=e.clientY-r.top>r.height/2;bt(a?t+1:t)}}(e,i)},onDragEnd:xt},p().createElement(m.TableBodyCell,null,t.value),p().createElement(m.TableBodyCell,null,t.label),p().createElement(m.TableBodyCell,{className:w().descriptionCell},p().createElement("div",{className:w().descriptionContent},t.description)),p().createElement(m.TableBodyCell,null,p().createElement("div",{className:w().termActions},p().createElement(m.Button,{size:"small",label:l("actions.edit"),onClick:function(){return function(e){Ge(!0),He({uuid:e.uuid,path:e.path,value:e.value,label:e.label,description:e.description||""})}(t)}}),p().createElement(m.Button,{size:"small",color:"danger",label:l("actions.delete"),onClick:function(){return vt(t)}})))))}),null!==r&&r===it.terms.length&&n.push(a("after-last")),e&&n.push(p().createElement(m.TableRow,{key:"drop-zone",className:w().dropZoneRow,onDragOver:function(e){null!==rt.sourceIndex&&(e.preventDefault(),bt(it.terms.length))}},p().createElement(m.TableBodyCell,{colSpan:4}))),n}()))),p().createElement("form",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},onSubmit:gt},p().createElement(m.Typography,{variant:"subheading"},pe.uuid?l("terms.editTitle"):l("terms.addTitle")),p().createElement("div",{className:w().formGroup},p().createElement(m.Typography,{variant:"body",weight:"bold"},l("terms.fields.value")),p().createElement(m.Input,{value:pe.value,onChange:function(e){return ct("value",e.target.value)}})),p().createElement("div",{className:w().formGroup},p().createElement(m.Typography,{variant:"body",weight:"bold"},l("terms.fields.label")),p().createElement(m.Input,{value:pe.label,onChange:function(e){return ct("label",e.target.value)}})),p().createElement("div",{className:w().formGroup},p().createElement(m.Typography,{variant:"body",weight:"bold"},l("terms.fields.description")),p().createElement("textarea",{className:w().textarea,value:pe.description,onChange:function(e){return ct("description",e.target.value)}})),p().createElement("div",{style:{display:"flex",gap:"12px"}},p().createElement(m.Button,{type:"submit",size:"big",disabled:Ne,label:l("actions.save")}),p().createElement(m.Button,{type:"button",size:"big",label:l("actions.cancel"),onClick:function(){return me(D({},O))}}))))),!ve&&0===Y.length&&!ne&&p().createElement(m.Paper,{className:w().card},p().createElement(m.Typography,{variant:"body"},l("lists.empty"))))))}),p().createElement(A,{isOpen:Fe,t:l,siteLanguages:_,initialLanguage:T,onClose:function(){return Oe(!1)},onImport:ht}),p().createElement(R,{isOpen:Me,form:Xe,isSaving:Ne,t:l,languageCode:T,languageName:null==wt?void 0:wt.displayName,onChange:function(e,t){He(function(r){return D(D({},r),{},(0,u.A)({},e,t))})},onClose:function(){return Ge(!1)},onSave:ft}))},M=function(e){var t=e.width,r=void 0===t?12:t,a=e.height,n=void 0===a?12:a;return p().createElement("svg",{width:r,height:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},p().createElement("path",{d:"M4.5 6.5l1.8 1.8 3.2-3.3 1.1 1.1-4.3 4.4-2.9-2.9 1.1-1.1z"}),p().createElement("rect",{x:"12",y:"6",width:"8",height:"2",rx:"1"}),p().createElement("path",{d:"M4.5 12.5l1.8 1.8 3.2-3.3 1.1 1.1-4.3 4.4-2.9-2.9 1.1-1.1z"}),p().createElement("rect",{x:"12",y:"12",width:"8",height:"2",rx:"1"}),p().createElement("path",{d:"M4.5 18.5l1.8 1.8 3.2-3.3 1.1 1.1-4.3 4.4-2.9-2.9 1.1-1.1z"}),p().createElement("rect",{x:"12",y:"18",width:"8",height:"2",rx:"1"}))},G=function(e){var t=e.width,r=void 0===t?12:t,a=e.height,n=void 0===a?12:a;return p().createElement("svg",{width:r,height:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},p().createElement("path",{d:"M10 3h4v4h-4V3zM4 13h4v4H4v-4zm12 0h4v4h-4v-4zM12 7v3h-6v3m6-6v3h6v3"}))},$=function(){window.jahia.i18n.loadNamespaces("controlled-lists"),a.registry.add("accordionItem","modelsAccordion",a.registry.get("accordionItem","renderDefaultApps"),{targets:["jcontent:75"],icon:p().createElement(G,{width:24,height:24}),label:"controlled-lists:accordionTitle",appsTarget:"modelsAccordionApps"}),a.registry.add("adminRoute","controlled-lists",{targets:["modelsAccordionApps"],icon:p().createElement(M,null),label:"controlled-lists:label",path:"".concat(s,"*"),defaultPath:s,isSelectable:!0,render:function(e){return p().createElement(d.Suspense,{fallback:"loading ..."},p().createElement(V,{match:e.match}))}})};M.propTypes={width:C().number,height:C().number},G.propTypes={width:C().number,height:C().number};var K=r(1793),X=r.n(K);const H=JSON.parse('{"controlled-lists":{"label":"Controlled lists","pageTitle":"Controlled lists","pageSubtitle":"Store centrally managed key/value lists for editors and developers.","states":{"loading":"Loading controlled lists..."},"errors":{"missingSite":"Please select a site to use controlled lists.","requiredFields":"System name and title are mandatory.","duplicateSystemName":"A list already uses the system name \\"{{name}}\\".","duplicateTermValue":"A term already uses the value \\"{{value}}\\"."},"actions":{"createList":"New list","reload":"Reload","save":"Save","cancel":"Cancel","delete":"Delete","edit":"Edit","actionsColumn":"Actions","importTerms":"Import terms"},"lists":{"title":"Lists","empty":"No controlled lists yet.","createTitle":"Create a new list","editTitle":"Edit list","fields":{"systemName":"System name","title":"Title","description":"Description"},"help":{"systemName":"Unique identifier used by developers and APIs."},"deleteConfirm":"Delete the list \\"{{title}}\\"?"},"terms":{"title":"Terms","empty":"No terms defined for this list.","addTitle":"Add a term","editTitle":"Edit term","fields":{"value":"Value","label":"Label","description":"Description"},"deleteConfirm":"Delete the term \\"{{label}}\\"?"},"feedback":{"listCreated":"List created successfully.","listUpdated":"List updated.","listDeleted":"List deleted.","termCreated":"Term created.","termUpdated":"Term updated.","termDeleted":"Term deleted.","termImported":"{{count}} term(s) imported.","termReordered":"Term order updated."},"edit":{"title":"Edit term"},"import":{"title":"Import terms","instructions":"Upload a CSV (columns: value,label,description) or a JSON array with those properties.","selectFile":"Choose CSV or JSON file","supportedFormats":"Supported formats: CSV, JSON","parsing":"Parsing file...","preview":"Preview ({{count}} rows)","moreRows":"and {{count}} more...","importButton":"Import","language":"Language","override":"Overwrite existing translations","errors":{"invalidFormat":"The file format is invalid. Ensure it contains value, label, and description fields.","readFailed":"Unable to read file.","noValidRows":"No valid rows were found to import.","noList":"Please select a list before importing terms.","noLanguage":"Please select a language."}},"accordionTitle":"Taxonomy tools"}}'),Y=JSON.parse('{"controlled-lists":{"label":"Listes contrÃ´lÃ©es","pageTitle":"Listes contrÃ´lÃ©es","pageSubtitle":"GÃ©rez des listes clÃ©/valeur rÃ©utilisables dans toute la plateforme.","states":{"loading":"Chargement des listes contrÃ´lÃ©es..."},"errors":{"missingSite":"Merci de sÃ©lectionner un site pour utiliser les listes contrÃ´lÃ©es.","requiredFields":"Le nom systÃ¨me et le titre sont obligatoires.","duplicateSystemName":"Une liste utilise dÃ©jÃ  le nom systÃ¨me \\"{{name}}\\".","duplicateTermValue":"Un terme utilise dÃ©jÃ  la valeur \\"{{value}}\\"."},"actions":{"createList":"Nouvelle liste","reload":"RafraÃ®chir","save":"Enregistrer","cancel":"Annuler","delete":"Supprimer","edit":"Modifier","actionsColumn":"Actions","importTerms":"Importer des termes"},"lists":{"title":"Listes","empty":"Aucune liste contrÃ´lÃ©e pour l\'instant.","createTitle":"CrÃ©er une nouvelle liste","editTitle":"Modifier la liste","fields":{"systemName":"Nom systÃ¨me","title":"Titre","description":"Description"},"help":{"systemName":"Identifiant unique utilisÃ© par les dÃ©veloppeurs et les API."},"deleteConfirm":"Supprimer la liste \\"{{title}}\\" ?"},"terms":{"title":"Termes","empty":"Aucun terme n\'est dÃ©fini pour cette liste.","addTitle":"Ajouter un terme","editTitle":"Modifier le terme","fields":{"value":"Valeur","label":"LibellÃ©","description":"Description"},"deleteConfirm":"Supprimer le terme \\"{{label}}\\" ?"},"feedback":{"listCreated":"Liste crÃ©Ã©e.","listUpdated":"Liste mise Ã  jour.","listDeleted":"Liste supprimÃ©e.","termCreated":"Terme crÃ©Ã©.","termUpdated":"Terme mis Ã  jour.","termDeleted":"Terme supprimÃ©.","termImported":"{{count}} terme(s) importÃ©(s).","termReordered":"Ordre des termes mis Ã  jour."},"edit":{"title":"Modifier le terme"},"import":{"title":"Importer des termes","instructions":"TÃ©lÃ©chargez un fichier CSV (colonnes : value,label,description) ou un JSON contenant ces propriÃ©tÃ©s.","selectFile":"Choisir un fichier CSV ou JSON","supportedFormats":"Formats pris en charge : CSV, JSON","parsing":"Analyse du fichier...","preview":"AperÃ§u ({{count}} lignes)","moreRows":"et {{count}} de plus...","importButton":"Importer","language":"Langue","override":"Ã‰craser les traductions existantes","errors":{"invalidFormat":"Format de fichier invalide. Assurez-vous que les champs value, label et description sont prÃ©sents.","readFailed":"Impossible de lire le fichier.","noValidRows":"Aucune ligne valide Ã  importer.","noList":"SÃ©lectionnez une liste avant d\'importer des termes.","noLanguage":"Merci de sÃ©lectionner une langue."}},"accordionTitle":"Outils de taxonomie"}}'),Z=JSON.parse('{"controlled-lists":{"label":"Listen verwalten","pageTitle":"Kontrollierte Listen","pageSubtitle":"Pflegen Sie zentral gesteuerte SchlÃ¼ssel/Wert-Listen fÃ¼r Redakteure und Entwickler.","states":{"loading":"Kontrollierte Listen werden geladen..."},"errors":{"missingSite":"Bitte wÃ¤hlen Sie eine Seite aus, um kontrollierte Listen zu verwenden.","requiredFields":"Systemname und Titel sind Pflichtfelder.","duplicateSystemName":"Eine Liste verwendet bereits den Systemnamen \\"{{name}}\\".","duplicateTermValue":"Ein Begriff verwendet bereits den Wert \\"{{value}}\\"."},"actions":{"createList":"Neue Liste","reload":"Aktualisieren","save":"Speichern","cancel":"Abbrechen","delete":"LÃ¶schen","edit":"Bearbeiten","actionsColumn":"Aktionen","importTerms":"Begriffe importieren"},"lists":{"title":"Listen","empty":"Noch keine kontrollierten Listen vorhanden.","createTitle":"Neue Liste anlegen","editTitle":"Liste bearbeiten","fields":{"systemName":"Systemname","title":"Titel","description":"Beschreibung"},"help":{"systemName":"Eindeutiger Bezeichner fÃ¼r Entwickler und APIs."},"deleteConfirm":"Liste \\"{{title}}\\" lÃ¶schen?"},"terms":{"title":"Begriffe","empty":"FÃ¼r diese Liste sind keine Begriffe definiert.","addTitle":"Begriff hinzufÃ¼gen","editTitle":"Begriff bearbeiten","fields":{"value":"Wert","label":"Bezeichnung","description":"Beschreibung"},"deleteConfirm":"Begriff \\"{{label}}\\" lÃ¶schen?"},"feedback":{"listCreated":"Liste wurde erstellt.","listUpdated":"Liste wurde aktualisiert.","listDeleted":"Liste wurde gelÃ¶scht.","termCreated":"Begriff wurde erstellt.","termUpdated":"Begriff wurde aktualisiert.","termDeleted":"Begriff wurde gelÃ¶scht.","termImported":"{{count}} Begriff(e) importiert.","termReordered":"Reihenfolge der Begriffe aktualisiert."},"edit":{"title":"Begriff bearbeiten"},"import":{"title":"Begriffe importieren","instructions":"CSV (Spalten: value,label,description) oder eine JSON-Liste mit diesen Feldern hochladen.","selectFile":"CSV oder JSON wÃ¤hlen","supportedFormats":"UnterstÃ¼tzte Formate: CSV, JSON","parsing":"Datei wird analysiert ...","preview":"Vorschau ({{count}} Zeilen)","moreRows":"und {{count}} weitere...","importButton":"Importieren","language":"Sprache","override":"Bestehende Ãœbersetzungen Ã¼berschreiben","errors":{"invalidFormat":"UngÃ¼ltiges Dateiformat. Stellen Sie sicher, dass value, label und description enthalten sind.","readFailed":"Datei konnte nicht gelesen werden.","noValidRows":"Keine gÃ¼ltigen Zeilen zum Import gefunden.","noList":"Bitte wÃ¤hlen Sie vor dem Import eine Liste aus.","noLanguage":"Bitte wÃ¤hlen Sie eine Sprache."}},"accordionTitle":"Taxonomie-Tools"}}'),W=JSON.parse('{"controlled-lists":{"label":"Listas controladas","pageTitle":"Listas controladas","pageSubtitle":"Administra listas clave/valor reutilizables para editores y desarrolladores.","states":{"loading":"Cargando listas controladas..."},"errors":{"missingSite":"Selecciona un sitio para usar las listas controladas.","requiredFields":"El nombre del sistema y el tÃ­tulo son obligatorios.","duplicateSystemName":"Ya existe una lista con el nombre de sistema \\"{{name}}\\".","duplicateTermValue":"Ya existe un tÃ©rmino con el valor \\"{{value}}\\"."},"actions":{"createList":"Nueva lista","reload":"Recargar","save":"Guardar","cancel":"Cancelar","delete":"Eliminar","edit":"Editar","actionsColumn":"Acciones","importTerms":"Importar tÃ©rminos"},"lists":{"title":"Listas","empty":"No hay listas controladas todavÃ­a.","createTitle":"Crear una nueva lista","editTitle":"Editar lista","fields":{"systemName":"Nombre del sistema","title":"TÃ­tulo","description":"DescripciÃ³n"},"help":{"systemName":"Identificador Ãºnico usado por desarrolladores y APIs."},"deleteConfirm":"Â¿Eliminar la lista \\"{{title}}\\"?"},"terms":{"title":"TÃ©rminos","empty":"No hay tÃ©rminos definidos para esta lista.","addTitle":"Agregar tÃ©rmino","editTitle":"Editar tÃ©rmino","fields":{"value":"Valor","label":"Etiqueta","description":"DescripciÃ³n"},"deleteConfirm":"Â¿Eliminar el tÃ©rmino \\"{{label}}\\"?"},"feedback":{"listCreated":"Lista creada correctamente.","listUpdated":"Lista actualizada.","listDeleted":"Lista eliminada.","termCreated":"TÃ©rmino creado.","termUpdated":"TÃ©rmino actualizado.","termDeleted":"TÃ©rmino eliminado.","termImported":"{{count}} tÃ©rmino(s) importado(s).","termReordered":"Orden de tÃ©rminos actualizado."},"edit":{"title":"Editar tÃ©rmino"},"import":{"title":"Importar tÃ©rminos","instructions":"Carga un CSV (columnas: value, label, description) o JSON con esas propiedades.","selectFile":"Elegir archivo CSV o JSON","supportedFormats":"Formatos admitidos: CSV, JSON","parsing":"Analizando archivo...","preview":"PrevisualizaciÃ³n ({{count}} filas)","moreRows":"y {{count}} mÃ¡s...","importButton":"Importar","language":"Idioma","override":"Sobrescribir traducciones existentes","errors":{"invalidFormat":"El formato del archivo es invÃ¡lido. AsegÃºrate de que incluya value, label y description.","readFailed":"No se pudo leer el archivo.","noValidRows":"No se encontraron filas vÃ¡lidas para importar.","noList":"Selecciona una lista antes de importar.","noLanguage":"Selecciona un idioma."}},"accordionTitle":"Herramientas de taxonomÃ­a"}}'),Q=JSON.parse('{"controlled-lists":{"label":"Listas controladas","pageTitle":"Listas controladas","pageSubtitle":"Mantenha listas chave/valor reutilizÃ¡veis para editores e desenvolvedores.","states":{"loading":"Carregando listas controladas..."},"errors":{"missingSite":"Selecione um site para usar as listas controladas.","requiredFields":"Nome do sistema e tÃ­tulo sÃ£o obrigatÃ³rios.","duplicateSystemName":"JÃ¡ existe uma lista com o nome \\"{{name}}\\".","duplicateTermValue":"JÃ¡ existe um termo com o valor \\"{{value}}\\"."},"actions":{"createList":"Nova lista","reload":"Recarregar","save":"Salvar","cancel":"Cancelar","delete":"Excluir","edit":"Editar","actionsColumn":"AÃ§Ãµes","importTerms":"Importar termos"},"lists":{"title":"Listas","empty":"Ainda nÃ£o hÃ¡ listas controladas.","createTitle":"Criar nova lista","editTitle":"Editar lista","fields":{"systemName":"Nome do sistema","title":"TÃ­tulo","description":"DescriÃ§Ã£o"},"help":{"systemName":"Identificador Ãºnico usado por desenvolvedores e APIs."},"deleteConfirm":"Excluir a lista \\"{{title}}\\"?"},"terms":{"title":"Termos","empty":"Nenhum termo definido para esta lista.","addTitle":"Adicionar termo","editTitle":"Editar termo","fields":{"value":"Valor","label":"RÃ³tulo","description":"DescriÃ§Ã£o"},"deleteConfirm":"Excluir o termo \\"{{label}}\\"?"},"feedback":{"listCreated":"Lista criada.","listUpdated":"Lista atualizada.","listDeleted":"Lista excluÃ­da.","termCreated":"Termo criado.","termUpdated":"Termo atualizado.","termDeleted":"Termo excluÃ­do.","termImported":"{{count}} termo(s) importado(s).","termReordered":"Ordem dos termos atualizada."},"edit":{"title":"Editar termo"},"import":{"title":"Importar termos","instructions":"Envie um CSV (colunas: value,label,description) ou um JSON com essas propriedades.","selectFile":"Escolher arquivo CSV ou JSON","supportedFormats":"Formatos suportados: CSV, JSON","parsing":"Analisando arquivo...","preview":"PrÃ©via ({{count}} linhas)","moreRows":"e mais {{count}}...","importButton":"Importar","language":"Idioma","override":"Substituir traduÃ§Ãµes existentes","errors":{"invalidFormat":"Formato de arquivo invÃ¡lido. Certifique-se de que contenha value, label e description.","readFailed":"NÃ£o foi possÃ­vel ler o arquivo.","noValidRows":"Nenhuma linha vÃ¡lida encontrada.","noList":"Selecione uma lista antes de importar.","noLanguage":"Selecione um idioma."}},"accordionTitle":"Ferramentas de taxonomia"}}'),ee=JSON.parse('{"controlled-lists":{"label":"Liste controllate","pageTitle":"Liste controllate","pageSubtitle":"Gestisci liste chiave/valore centralizzate per editor e sviluppatori.","states":{"loading":"Caricamento delle liste controllate..."},"errors":{"missingSite":"Seleziona un sito per usare le liste controllate.","requiredFields":"Nome di sistema e titolo sono obbligatori.","duplicateSystemName":"Esiste giÃ  una lista con il nome di sistema \\"{{name}}\\".","duplicateTermValue":"Esiste giÃ  un termine con il valore \\"{{value}}\\"."},"actions":{"createList":"Nuova lista","reload":"Ricarica","save":"Salva","cancel":"Annulla","delete":"Elimina","edit":"Modifica","actionsColumn":"Azioni","importTerms":"Importa termini"},"lists":{"title":"Liste","empty":"Nessuna lista controllata disponibile.","createTitle":"Crea nuova lista","editTitle":"Modifica lista","fields":{"systemName":"Nome di sistema","title":"Titolo","description":"Descrizione"},"help":{"systemName":"Identificatore univoco usato da sviluppatori e API."},"deleteConfirm":"Eliminare la lista \\"{{title}}\\"?"},"terms":{"title":"Termini","empty":"Nessun termine definito per questa lista.","addTitle":"Aggiungi termine","editTitle":"Modifica termine","fields":{"value":"Valore","label":"Etichetta","description":"Descrizione"},"deleteConfirm":"Eliminare il termine \\"{{label}}\\"?"},"feedback":{"listCreated":"Lista creata.","listUpdated":"Lista aggiornata.","listDeleted":"Lista eliminata.","termCreated":"Termine creato.","termUpdated":"Termine aggiornato.","termDeleted":"Termine eliminato.","termImported":"{{count}} termine/i importati.","termReordered":"Ordine dei termini aggiornato."},"edit":{"title":"Modifica termine"},"import":{"title":"Importa termini","instructions":"Carica un CSV (colonne: value, label, description) o un JSON con le stesse proprietÃ .","selectFile":"Scegli file CSV o JSON","supportedFormats":"Formati supportati: CSV, JSON","parsing":"Analisi del file in corso...","preview":"Anteprima ({{count}} righe)","moreRows":"e altre {{count}}...","importButton":"Importa","language":"Lingua","override":"Sovrascrivi traduzioni esistenti","errors":{"invalidFormat":"Formato file non valido. Assicurati di includere value, label e description.","readFailed":"Impossibile leggere il file.","noValidRows":"Nessuna riga valida trovata.","noList":"Seleziona una lista prima di importare.","noLanguage":"Seleziona una lingua."}},"accordionTitle":"Strumenti di tassonomia"}}');var te=function(e){var t,r=e.value,a=e.onChange,l=e.language,s=window.contextJsParameters||{},u=s.siteKey||(null===(t=s.site)||void 0===t?void 0:t.key)||"",g=l||s.lang||s.language||s.uilang||"en",v=(0,d.useState)(u?"/sites/".concat(u,"/contents/controlled-lists"):null),h=(0,i.A)(v,1)[0],b=(0,d.useState)([]),y=(0,i.A)(b,2),x=y[0],E=y[1],C=(0,d.useState)(!1),N=(0,i.A)(C,2),T=N[0],S=N[1],k=(0,d.useState)(null),L=(0,i.A)(k,2),I=L[0],A=L[1],P=(0,d.useMemo)(function(){return function(e){if(!e)return{listId:null,terms:[]};try{var t=JSON.parse(e);return{listId:t.listId||null,terms:Array.isArray(t.terms)?t.terms:[]}}catch(e){return{listId:null,terms:[]}}}(r)},[r]),R=x.find(function(e){return e.uuid===P.listId})||null,_=(0,d.useMemo)(function(){return new Set(P.terms.map(function(e){return e.uuid}))},[P.terms]);(0,d.useEffect)(function(){if(h){var e=function(){var e=(0,n.A)(o().mark(function e(){var t,r,a,n,i,l;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return S(!0),A(null),e.prev=1,e.next=2,f().post("".concat(s.contextPath||"","/modules/graphql"),{query:'\n    query SelectorControlledLists($rootPath: String!, $language: String!) {\n        jcr {\n            nodeByPath(path: $rootPath) {\n                children(typesFilter: {types: ["cl:controlledList"]}) {\n                    nodes {\n                        uuid\n                        name\n                        title: property(name: "jcr:title", language: $language) {\n                            value\n                        }\n                        children(typesFilter: {types: ["cl:controlledTerm"]}) {\n                            nodes {\n                                uuid\n                                termValue: property(name: "cl:value") {\n                                    value\n                                }\n                                termLabel: property(name: "cl:label", language: $language) {\n                                    value\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n',variables:{rootPath:h,language:g}},{headers:{"Content-Type":"application/json"},withCredentials:!0});case 2:if(a=e.sent,null===(t=a.data)||void 0===t||null===(t=t.errors)||void 0===t||!t.length){e.next=3;break}throw new Error(a.data.errors.map(function(e){return e.message}).join("\n"));case 3:n=(null===(r=a.data)||void 0===r||null===(r=r.data)||void 0===r||null===(r=r.jcr)||void 0===r||null===(r=r.nodeByPath)||void 0===r||null===(r=r.children)||void 0===r?void 0:r.nodes)||[],(i=n.map(function(e){var t,r;return{uuid:e.uuid,name:e.name,label:(null===(t=e.title)||void 0===t?void 0:t.value)||e.name,terms:((null===(r=e.children)||void 0===r?void 0:r.nodes)||[]).map(function(e){var t,r,a;return{uuid:e.uuid,value:(null===(t=e.termValue)||void 0===t?void 0:t.value)||"",label:(null===(r=e.termLabel)||void 0===r?void 0:r.value)||(null===(a=e.termValue)||void 0===a?void 0:a.value)||""}})}})).sort(function(e,t){return e.label.localeCompare(t.label)}),E(i),e.next=5;break;case 4:e.prev=4,l=e.catch(1),A(l);case 5:return e.prev=5,S(!1),e.finish(5);case 6:case"end":return e.stop()}},e,null,[[1,4,5,6]])}));return function(){return e.apply(this,arguments)}}();e()}},[s.contextPath,g,h,u]);if(!h)return p().createElement(m.Typography,{variant:"body"},s.siteKey?"Missing lists root.":"Please select a site.");if(T)return p().createElement("div",{className:w().selectorLoading},p().createElement(m.Loader,{size:"big"}),p().createElement(m.Typography,{variant:"body"},"Loading controlled lists..."));if(I)return p().createElement(m.Typography,{variant:"body",color:"danger"},I.message);var D=x.map(function(e){return{label:e.label,value:e.uuid}});return p().createElement(m.Paper,{className:w().selectorCard},p().createElement("div",{className:w().selectorContainer},p().createElement("div",{className:w().formGroup},p().createElement(m.Typography,{variant:"body",weight:"bold"},"Controlled list"),p().createElement(m.Dropdown,{data:D,value:(null==R?void 0:R.uuid)||null,placeholder:"Select a controlled list",onChange:function(e,t){var r=t.value;a(r?JSON.stringify({listId:r,terms:[]}):"")}})),R&&p().createElement("div",{className:w().selectorTerms},p().createElement(m.Typography,{variant:"body",weight:"bold"},"Terms ",g&&"(".concat(B(g)," ").concat(g.toUpperCase(),")")),p().createElement("div",{className:w().selectorTermsList},R.terms.map(function(e){return p().createElement(m.CheckboxItem,{key:e.uuid,label:e.label,description:e.value,checked:_.has(e.uuid),onChange:function(){return function(e){var t;t=_.has(e.uuid)?P.terms.filter(function(t){return t.uuid!==e.uuid}):[].concat((0,c.A)(P.terms),[e]),a(JSON.stringify({listId:(null==R?void 0:R.uuid)||null,terms:t}))}(e)}})})),P.terms.length>0&&p().createElement("div",{className:w().selectorSelection},p().createElement(m.Typography,{variant:"body",weight:"bold"},"Selected"),p().createElement("div",{className:w().selectorChips},P.terms.map(function(e){return p().createElement(m.Chip,{key:e.uuid,label:e.label})})),p().createElement(m.Button,{size:"small",label:"Clear selection",onClick:function(){return a(JSON.stringify({listId:R.uuid,terms:[]}))}})))))};te.propTypes={value:C().string,onChange:C().func.isRequired,language:C().string},te.defaultProps={value:"",language:null};var re=function(){[["en",H],["fr",Y],["de",Z],["es",W],["pt",Q],["it",ee]].forEach(function(e){var t=(0,i.A)(e,2),r=t[0],a=t[1]["controlled-lists"];a&&!X().hasResourceBundle(r,"controlled-lists")&&X().addResourceBundle(r,"controlled-lists",a,!0,!0)})};function ae(){return ne.apply(this,arguments)}function ne(){return(ne=(0,n.A)(o().mark(function e(){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return re(),e.next=1,X().loadNamespaces("controlled-lists");case 1:a.registry.add("selectorType","controlledListsSelector",{cmp:te,supportMultiple:!1}),$();case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ie(){a.registry.add("callback","controlled-lists",{targets:["jahiaApp-init:2"],callback:ae})}},9838:()=>{}}]);
//# sourceMappingURL=137.jahia.81be75.js.map