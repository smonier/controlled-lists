(self.webpackChunkcontrolled_lists=self.webpackChunkcontrolled_lists||[]).push([[137],{1696:(e,t,r)=>{var a=r(5072),n=r(3983);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);a(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},3983:(e,t,r)=>{(t=r(6314)(!1)).push([e.id,"._1PQH6q0mtbs4crV1y6q9qy{display:flex;flex-direction:column;gap:16px}._1A05Oh_PN9Msb5g83hN8nL{display:flex;gap:24px;padding:24px;background:#fff;border-radius:8px;box-shadow:0 10px 30px rgba(20,46,110,.08)}._3cPq4N1KSjwiBOX1DkH9LO{width:280px;display:flex;flex-direction:column;gap:16px}._2VoRZmBKI4EuRCbW3mff0t{display:flex;flex-direction:column;gap:8px;max-height:500px;overflow-y:auto;padding-right:4px}._3VG3297pCbJuXKNadjRvkR{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border-radius:6px;border:1px solid #dfe4ef;background:#f9fbff;color:#2d3c5a;font-weight:500;cursor:pointer;transition:all .15s ease-in-out}._17nxPW6a6DUqYLMS9h14Yy{border-color:#2681ff;background:rgba(38,129,255,.1);color:#0c2c66}._3igPUo8BnUO_wc31tr_H-g{flex:1;display:flex;flex-direction:column;gap:16px}._3n6apRuumcI6wNujWpKraS{padding:20px;border-radius:8px;border:1px solid #e0e7ff;background:#fff;box-shadow:0 4px 14px rgba(21,34,50,.05)}._bFPawBurox5-NUlaWxIk{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;gap:12px}._1j-tnyn89SnwOC9kJMQ3Xp{display:flex;flex-direction:column;gap:6px;margin-bottom:14px}._38bw5B7WvGqDqaNaGaFX98{min-height:90px;padding:10px;border-radius:6px;border:1px solid #d7deef;font-size:14px;resize:vertical;font-family:inherit}.OwGuLXezbhuJW-eHPSsru{padding:12px 14px;border-radius:6px;font-weight:500}.p1DO0IJ-_-63KEQDSUYBj{background:#e5f5ed;color:#126235;border:1px solid rgba(18,98,53,.3)}._3zASdNW_fBcrOxlM7hNN1v{background:#fdeaea;color:#aa1b1b;border:1px solid rgba(170,27,27,.3)}._2_LZptxYoLLZx7nsqwkIMl{position:fixed;inset:0;background:rgba(12,23,41,.55);display:flex;align-items:center;justify-content:center;z-index:9999}._170FQmFmz_gcpGYls3WZG7{width:min(640px,90vw);background:#fff;border-radius:10px;box-shadow:0 25px 45px rgba(15,23,42,.25);display:flex;flex-direction:column;max-height:90vh}._1cyKmkaU_UXmsTbqVgYIcF{padding:20px;border-bottom:1px solid #ebf0ff;display:flex;flex-direction:column;gap:8px}._1Z2R9WLApLOduzmC6gFAQS{padding:20px;overflow-y:auto;display:flex;flex-direction:column;gap:16px}._190GCFfxfMwyVXivmvuxwo{display:flex;justify-content:flex-end;gap:12px;padding:16px 20px;border-top:1px solid #ebf0ff}.JSa-BSQOumNUnYWXn2BNy{display:none}._1hnPa4jhJqcc2iIzXRmDVz{width:100%;min-height:100px;border:1px solid #d7deef;border-radius:6px;padding:6px 8px;font-family:inherit}._2PnaNvl6mE4hCP74R4kpcN{border:1px solid #e0e7ff;border-radius:8px;padding:12px;background:#f7f9ff}._3AsUwzGPjymDzjKfzDN6xe{display:flex;flex-direction:column;gap:8px;margin-top:8px}._2HmD6UTeGiDaBBPm4gFm6U{display:flex;flex-direction:column;gap:2px;padding-bottom:8px;border-bottom:1px solid #dfe4ef}._2HmD6UTeGiDaBBPm4gFm6U:last-child{border-bottom:none;padding-bottom:0}._3xPZZe8d5acBeUGmuR1kdy{white-space:normal !important;word-break:break-word !important;white-space:normal;word-break:break-word}._3aRSOcDHAJnrC5ejCGpBBn{display:flex;align-items:center;gap:8px;cursor:pointer}._3TCfDCabL9C0aF__Gj5sQw{white-space:normal;word-break:break-word;line-height:1.4}.HNLsRvwmpjTKA0j1XnTal{display:flex;flex-wrap:wrap;gap:8px}._3EJmpupIpCnJIOULXhrarZ .moonstone-TableRow{min-height:72px !important;height:auto !important}._3EJmpupIpCnJIOULXhrarZ .moonstone-tableBodyCell{vertical-align:top !important;padding-top:12px !important;padding-bottom:12px !important;line-height:1.4;overflow:visible !important}._3EJmpupIpCnJIOULXhrarZ .moonstone-tableCellContent{overflow:visible !important;white-space:normal}.aPUOvBmsU7YlNMM2UR5DX{cursor:grab}._190P4pe4hDL9tGdKHez1TQ{cursor:default}._24-NPJ0XmStYfCPwrYCBTh{opacity:.5}._2sMm5P6Je6Fc7R52FPMzIK{pointer-events:none;height:64px;background:rgba(38,129,255,.08)}._2sMm5P6Je6Fc7R52FPMzIK td{padding:12px !important;border:2px dashed #2681ff !important}._1LnAJFLdBdIVPlcdHk9Jnm{height:100%}._3u2rFNMykvPolpekpzA0oV{height:24px}.kKsfJRXh3rGu8NXEYeMJm{display:flex;gap:8px;margin-bottom:16px}._36n29SKvu2sPZp3FlTFdl6{border:1px solid #dfe4ef;background:#f7f7fb;padding:6px 12px;border-radius:6px;cursor:pointer;transition:all .15s ease-in-out;display:flex;gap:6px;align-items:center}.GnpGvbo8as636bpOXCnUJ{background:rgba(38,129,255,.12);border-color:#2681ff;color:#0c2c66;font-weight:600}._22VH06o13uJx2wqDfRkjhB{font-size:16px}._2aCI0xfJ8awvT6F20WYCjq{display:inline-flex;align-items:center;gap:6px;font-weight:600}._3ls-z6Ob5PmXxsLLpIYRDD{padding:16px;border-radius:8px}._37TjsXi7Rzd2G5rcIJppC0{display:flex;flex-direction:column;gap:16px}._1NY17Ti4RX3L7GVRMkUKnc{display:flex;align-items:center;gap:12px}._2CnN5F_Xy-LKUU8Fqew7Aj{display:flex;flex-direction:column;gap:12px}._2GeCQKpF_y3RubogwhVqKN{display:flex;flex-direction:column;gap:8px;max-height:240px;overflow-y:auto;padding-right:4px}._2GeCQKpF_y3RubogwhVqKN .moonstone-checkboxItem__description{display:block;width:100%;text-align:right !important;margin-left:auto;align-self:flex-end}.kZFxvhRy9gzUJwwM9jvmS{display:flex;flex-direction:column;gap:8px}._1KQDYBSKhiDuHajyyBC1sq{display:flex;flex-wrap:wrap;gap:8px}",""]),t.locals={layout:"_1PQH6q0mtbs4crV1y6q9qy",container:"_1A05Oh_PN9Msb5g83hN8nL",listPanel:"_3cPq4N1KSjwiBOX1DkH9LO",listsContainer:"_2VoRZmBKI4EuRCbW3mff0t",listButton:"_3VG3297pCbJuXKNadjRvkR",listButtonActive:"_17nxPW6a6DUqYLMS9h14Yy",contentPanel:"_3igPUo8BnUO_wc31tr_H-g",card:"_3n6apRuumcI6wNujWpKraS",cardHeader:"_bFPawBurox5-NUlaWxIk",formGroup:"_1j-tnyn89SnwOC9kJMQ3Xp",textarea:"_38bw5B7WvGqDqaNaGaFX98",feedback:"OwGuLXezbhuJW-eHPSsru",feedbackSuccess:"p1DO0IJ-_-63KEQDSUYBj",feedbackError:"_3zASdNW_fBcrOxlM7hNN1v",dialogOverlay:"_2_LZptxYoLLZx7nsqwkIMl",dialog:"_170FQmFmz_gcpGYls3WZG7",dialogHeader:"_1cyKmkaU_UXmsTbqVgYIcF",dialogBody:"_1Z2R9WLApLOduzmC6gFAQS",dialogActions:"_190GCFfxfMwyVXivmvuxwo",hiddenInput:"JSa-BSQOumNUnYWXn2BNy",inlineTextarea:"_1hnPa4jhJqcc2iIzXRmDVz",previewBlock:"_2PnaNvl6mE4hCP74R4kpcN",previewList:"_3AsUwzGPjymDzjKfzDN6xe",previewItem:"_2HmD6UTeGiDaBBPm4gFm6U",descriptionCell:"_3xPZZe8d5acBeUGmuR1kdy",checkboxRow:"_3aRSOcDHAJnrC5ejCGpBBn",descriptionContent:"_3TCfDCabL9C0aF__Gj5sQw",termActions:"HNLsRvwmpjTKA0j1XnTal",termsTable:"_3EJmpupIpCnJIOULXhrarZ",termRow:"aPUOvBmsU7YlNMM2UR5DX",termRowDragDisabled:"_190P4pe4hDL9tGdKHez1TQ",draggingRow:"_24-NPJ0XmStYfCPwrYCBTh",placeholderRow:"_2sMm5P6Je6Fc7R52FPMzIK",placeholderBar:"_1LnAJFLdBdIVPlcdHk9Jnm",dropZoneRow:"_3u2rFNMykvPolpekpzA0oV",languageTabs:"kKsfJRXh3rGu8NXEYeMJm",languageTab:"_36n29SKvu2sPZp3FlTFdl6",languageTabActive:"GnpGvbo8as636bpOXCnUJ",languageFlag:"_22VH06o13uJx2wqDfRkjhB",languageBadge:"_2aCI0xfJ8awvT6F20WYCjq",selectorCard:"_3ls-z6Ob5PmXxsLLpIYRDD",selectorContainer:"_37TjsXi7Rzd2G5rcIJppC0",selectorLoading:"_1NY17Ti4RX3L7GVRMkUKnc",selectorTerms:"_2CnN5F_Xy-LKUU8Fqew7Aj",selectorTermsList:"_2GeCQKpF_y3RubogwhVqKN",selectorSelection:"kZFxvhRy9gzUJwwM9jvmS",selectorChips:"_1KQDYBSKhiDuHajyyBC1sq"},e.exports=t},5340:()=>{},9219:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>oe});var a=r(3119),n=r(2816),i=r(7255),l=r(2207),o=r.n(l);const s="/controlled-lists";var c=r(8388),u=r(8557),d=r(3262),m=r.n(d),p=r(5066),g=r(2505),f=r.n(g),v=r(1658),h="\n    mutation DeleteControlledListNode($path: String!) {\n        jcr(workspace: EDIT) {\n            deleteNode(pathOrId: $path)\n        }\n    }\n",b='\n    mutation CreateControlledTerm($parentPath: String!, $name: String!, $properties: [InputJCRProperty]!) {\n        jcr(workspace: EDIT) {\n            addNode(\n                parentPathOrId: $parentPath\n                name: $name\n                primaryNodeType: "cl:controlledTerm"\n                properties: $properties\n            ) {\n                uuid\n            }\n        }\n    }\n',y="\n    mutation UpdateControlledTerm($path: String!, $properties: [InputJCRProperty]!) {\n        jcr(workspace: EDIT) {\n            mutateNode(pathOrId: $path) {\n                setPropertiesBatch(properties: $properties) {\n                    property {\n                        name\n                    }\n                }\n                uuid\n            }\n        }\n    }\n",x="\n    mutation RenameControlledList($path: String!, $name: String!) {\n        jcr(workspace: EDIT) {\n            mutateNode(pathOrId: $path) {\n                rename(name: $name)\n            }\n        }\n    }\n",w=r(1696),E=r.n(w),N=r(5556),C=r.n(N),S=r(9383),T=r.n(S),k=r(4199),L=r.n(k),I=function(e){return(e||[]).map(function(e){return{value:(e.value||"").trim(),label:(e.label||e.value||"").trim(),description:(e.description||"").trim()}}).filter(function(e){return e.value&&e.label})},A=function(e,t){var r;return t&&e.some(function(e){return e.code===t})?t:(null===(r=e[0])||void 0===r?void 0:r.code)||""},P=function(e){var t=e.isOpen,r=e.siteLanguages,a=e.initialLanguage,n=e.onClose,l=e.onImport,o=e.t,s=(0,d.useState)([]),c=(0,i.A)(s,2),u=c[0],g=c[1],f=(0,d.useState)(""),v=(0,i.A)(f,2),h=v[0],b=v[1],y=(0,d.useState)(null),x=(0,i.A)(y,2),w=x[0],N=x[1],C=(0,d.useState)(!1),S=(0,i.A)(C,2),k=S[0],P=S[1],B=(0,d.useState)(function(){return A(r,a)}),R=(0,i.A)(B,2),_=R[0],D=R[1],F=(0,d.useState)(!1),O=(0,i.A)(F,2),j=O[0],z=O[1],J=(0,d.useRef)(null),q=(0,d.useMemo)(function(){return(r||[]).map(function(e){return{label:e.displayName||e.code,value:e.code}})},[r]),U=(0,d.useCallback)(function(){g([]),b(""),N(null),P(!1),D(A(r,a)),z(!1)},[a,r]);return(0,d.useEffect)(function(){t||U()},[t,U]),(0,d.useEffect)(function(){D(function(e){return e&&r.some(function(t){return t.code===e})?e:A(r,a)})},[a,r]),t?T().createPortal(m().createElement("div",{className:E().dialogOverlay},m().createElement("div",{className:E().dialog},m().createElement("div",{className:E().dialogHeader},m().createElement(p.Typography,{variant:"heading"},o("import.title")),m().createElement(p.Typography,{variant:"body"},o("import.instructions"))),m().createElement("div",{className:E().dialogBody},m().createElement("div",{className:E().formGroup},m().createElement(p.Button,{size:"big",label:h||o("import.selectFile"),onClick:function(){var e;return null===(e=J.current)||void 0===e?void 0:e.click()}}),m().createElement("input",{ref:J,type:"file",accept:".csv,.json",className:E().hiddenInput,onChange:function(e){var t=e.target.files[0];if(t)if(P(!0),N(null),b(t.name),"json"===t.name.toLowerCase().split(".").pop()){var r=new FileReader;r.onload=function(e){try{var t=JSON.parse(e.target.result||"[]"),r=I(Array.isArray(t)?t:[]);if(!r.length)throw new Error(o("import.errors.invalidFormat"));g(r)}catch(e){g([]),N(e.message||o("import.errors.invalidFormat"))}finally{P(!1)}},r.onerror=function(){P(!1),N(o("import.errors.readFailed"))},r.readAsText(t)}else L().parse(t,{header:!0,skipEmptyLines:!0,complete:function(e){var t;if(null!=e&&null!==(t=e.errors)&&void 0!==t&&t.length)N(e.errors[0].message||o("import.errors.invalidFormat")),g([]);else{var r=I(e.data);0===r.length?N(o("import.errors.invalidFormat")):g(r)}P(!1)},error:function(e){g([]),P(!1),N(e.message||o("import.errors.invalidFormat"))}})}}),m().createElement(p.Typography,{variant:"caption"},o("import.supportedFormats"))),k&&m().createElement(p.Typography,{variant:"body"},o("import.parsing")),w&&m().createElement("div",{className:"".concat(E().feedback," ").concat(E().feedbackError)},w),Boolean(u.length)&&m().createElement("div",{className:E().previewBlock},m().createElement(p.Typography,{variant:"subheading"},o("import.preview",{count:u.length})),m().createElement("div",{className:E().previewList},u.slice(0,5).map(function(e){var t="".concat(e.value,"-").concat(e.label,"-").concat(e.description);return m().createElement("div",{key:t,className:E().previewItem},m().createElement("strong",null,e.value),m().createElement("span",null,e.label),e.description&&m().createElement("em",null,e.description))}),u.length>5&&m().createElement(p.Typography,{variant:"caption"},o("import.moreRows",{count:u.length-5})))),m().createElement("div",{className:E().formGroup},m().createElement(p.Typography,{variant:"body",weight:"bold"},o("import.language")),m().createElement(p.Dropdown,{data:q,value:_,placeholder:o("import.language"),onChange:function(e,t){return D(t.value)}})),m().createElement("div",{className:E().formGroup},m().createElement("label",{className:E().checkboxRow},m().createElement(p.Checkbox,{checked:j,onChange:function(e,t,r){return z(r)}}),m().createElement(p.Typography,{variant:"body"},o("import.override"))))),m().createElement("div",{className:E().dialogActions},m().createElement(p.Button,{size:"big",label:o("actions.cancel"),onClick:function(){n()}}),m().createElement(p.Button,{size:"big",color:"accent",isDisabled:!u.length||k,label:o("import.importButton"),onClick:function(){_?l(u,{language:_,overrideExisting:j}):N(o("import.errors.noLanguage"))}})))),document.body):null};P.propTypes={isOpen:C().bool.isRequired,siteLanguages:C().arrayOf(C().shape({code:C().string.isRequired,displayName:C().string})),initialLanguage:C().string,onClose:C().func.isRequired,onImport:C().func.isRequired,t:C().func.isRequired},P.defaultProps={siteLanguages:[],initialLanguage:""};var B={en:"ğŸ‡¬ğŸ‡§",fr:"ğŸ‡«ğŸ‡·",de:"ğŸ‡©ğŸ‡ª",es:"ğŸ‡ªğŸ‡¸",it:"ğŸ‡®ğŸ‡¹",pt:"ğŸ‡µğŸ‡¹",nl:"ğŸ‡³ğŸ‡±",ru:"ğŸ‡·ğŸ‡º",ja:"ğŸ‡¯ğŸ‡µ",zh:"ğŸ‡¨ğŸ‡³",ar:"ğŸ‡¸ğŸ‡¦",ko:"ğŸ‡°ğŸ‡·",pl:"ğŸ‡µğŸ‡±",tr:"ğŸ‡¹ğŸ‡·",sv:"ğŸ‡¸ğŸ‡ª",da:"ğŸ‡©ğŸ‡°",no:"ğŸ‡³ğŸ‡´",fi:"ğŸ‡«ğŸ‡®",cs:"ğŸ‡¨ğŸ‡¿",el:"ğŸ‡¬ğŸ‡·"},R=function(e){return B[e]||"ğŸŒ"},_=function(e){var t=e.isOpen,r=e.form,a=e.onChange,n=e.onClose,i=e.onSave,l=e.isSaving,o=e.t,s=e.languageCode,c=e.languageName;return t?T().createPortal(m().createElement("div",{className:E().dialogOverlay},m().createElement("div",{className:E().dialog},m().createElement("div",{className:E().dialogHeader},m().createElement(p.Typography,{variant:"heading"},o("edit.title")),s&&m().createElement(p.Typography,{variant:"body",className:E().languageBadge},R(s)," ",c||s.toUpperCase())),m().createElement("div",{className:E().dialogBody},m().createElement("div",{className:E().formGroup},m().createElement(p.Typography,{variant:"body",weight:"bold"},o("terms.fields.value")),m().createElement(p.Input,{value:r.value,onChange:function(e){return a("value",e.target.value)}})),m().createElement("div",{className:E().formGroup},m().createElement(p.Typography,{variant:"body",weight:"bold"},o("terms.fields.label")),m().createElement(p.Input,{value:r.label,onChange:function(e){return a("label",e.target.value)}})),m().createElement("div",{className:E().formGroup},m().createElement(p.Typography,{variant:"body",weight:"bold"},o("terms.fields.description")),m().createElement("textarea",{className:E().inlineTextarea,value:r.description,onChange:function(e){return a("description",e.target.value)}}))),m().createElement("div",{className:E().dialogActions},m().createElement(p.Button,{size:"big",label:o("actions.cancel"),onClick:n}),m().createElement(p.Button,{size:"big",color:"accent",isDisabled:l,label:o("actions.save"),onClick:i})))),document.body):null};function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach(function(t){(0,c.A)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}_.propTypes={isOpen:C().bool.isRequired,form:C().shape({value:C().string,label:C().string,description:C().string}).isRequired,onChange:C().func.isRequired,onClose:C().func.isRequired,onSave:C().func.isRequired,isSaving:C().bool,t:C().func.isRequired,languageCode:C().string,languageName:C().string};var O={uuid:null,path:"",systemName:"",title:"",description:""},j={uuid:null,path:"",value:"",label:"",description:""},z=function(e){return e.toString().normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[^\w\s-]/g,"").trim().replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"").toLowerCase()},J=function(e,t,r){var a=z(e)||r;if(!t.includes(a))return a;for(var n=1;t.includes("".concat(a,"-").concat(n));)n+=1;return"".concat(a,"-").concat(n)},q=function(e){return window.confirm(e)},U=function(e,t,r){if(!Array.isArray(e)||e.length<2)return null;if(null==t||null==r||t<0||t>=e.length)return null;var a=Math.max(0,Math.min(r,e.length)),n=(0,u.A)(e),l=n.splice(t,1),o=(0,i.A)(l,1)[0];if(!o)return null;var s=t<a?a-1:a;return n.splice(s,0,o),n.length===e.length&&n.every(function(t,r){return t.uuid===e[r].uuid})?null:n},M=function(e){var t,r,a;return{uuid:e.uuid,path:e.path,name:e.name,systemName:e.name,title:(null===(t=e.title)||void 0===t?void 0:t.value)||e.name,description:(null===(r=e.description)||void 0===r?void 0:r.value)||"",terms:((null===(a=e.children)||void 0===a?void 0:a.nodes)||[]).map(function(e){var t,r;return{uuid:e.uuid,path:e.path,name:e.name,value:e.name,label:(null===(t=e.termLabel)||void 0===t?void 0:t.value)||e.name,description:(null===(r=e.termDescription)||void 0===r?void 0:r.value)||""}})}},V=function(e){if(!Array.isArray(e))return[];var t=new Set,r=[];return e.forEach(function(e){if(e){var a=e.code;a&&!t.has(a)&&(r.push({code:a,displayName:e.displayName||a}),t.add(a))}}),r},G=function(){var e,t,r,a=(0,v.useTranslation)("controlled-lists"),l=a.t,s=a.i18n.language,g=window.contextJsParameters||{},w=g.siteKey||(null===(e=g.site)||void 0===e?void 0:e.key)||"",N=(null===(t=g.site)||void 0===t?void 0:t.displayName)||(null===(r=g.site)||void 0===r?void 0:r.name)||w||"",C=(0,d.useState)(s||"en"),S=(0,i.A)(C,2),T=S[0],k=S[1],L="".concat(g.contextPath||"","/modules/graphql"),I=V((g.siteLanguages||[]).map(function(e){return"string"==typeof e?{code:e,displayName:e}:{code:e.language||e.code,displayName:e.displayName||e.language||e.code}}).filter(function(e){return e.code})),A=(0,d.useState)(I),B=(0,i.A)(A,2),D=B[0],G=B[1],$=(0,d.useState)(""),K=(0,i.A)($,2),X=K[0],H=K[1],Y=(0,d.useState)([]),Z=(0,i.A)(Y,2),W=Z[0],Q=Z[1],ee=(0,d.useState)(null),te=(0,i.A)(ee,2),re=te[0],ae=te[1],ne=(0,d.useState)(!1),ie=(0,i.A)(ne,2),le=ie[0],oe=ie[1],se=(0,d.useState)(O),ce=(0,i.A)(se,2),ue=ce[0],de=ce[1],me=(0,d.useState)(j),pe=(0,i.A)(me,2),ge=pe[0],fe=pe[1],ve=(0,d.useState)(!1),he=(0,i.A)(ve,2),be=he[0],ye=he[1],xe=(0,d.useState)(!1),we=(0,i.A)(xe,2),Ee=we[0],Ne=we[1],Ce=(0,d.useState)(!1),Se=(0,i.A)(Ce,2),Te=Se[0],ke=Se[1],Le=(0,d.useState)(null),Ie=(0,i.A)(Le,2),Ae=Ie[0],Pe=Ie[1],Be=(0,d.useState)(null),Re=(0,i.A)(Be,2),_e=Re[0],De=Re[1],Fe=(0,d.useState)(!1),Oe=(0,i.A)(Fe,2),je=Oe[0],ze=Oe[1],Je=(0,d.useState)(!1),qe=(0,i.A)(Je,2),Ue=qe[0],Me=qe[1],Ve=(0,d.useState)(!1),Ge=(0,i.A)(Ve,2),$e=Ge[0],Ke=Ge[1],Xe=(0,d.useState)(j),He=(0,i.A)(Xe,2),Ye=He[0],Ze=He[1],We=(0,d.useState)(!1),Qe=(0,i.A)(We,2),et=Qe[0],tt=Qe[1],rt=(0,d.useState)({sourceIndex:null,targetIndex:null}),at=(0,i.A)(rt,2),nt=at[0],it=at[1];(0,d.useEffect)(function(){k(s||"en")},[s]);var lt=(0,d.useCallback)(function(){var e=(0,n.A)(o().mark(function e(t,r){var a,n,i;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,f().post(L,{query:t,variables:r},{headers:{"Content-Type":"application/json"},withCredentials:!0});case 1:if(n=e.sent,null===(a=n.data)||void 0===a||null===(a=a.errors)||void 0===a||!a.length){e.next=2;break}throw i=n.data.errors.map(function(e){return e.message}).join("\n"),new Error(i);case 2:return e.abrupt("return",n.data.data);case 3:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}(),[L]),ot=(0,d.useMemo)(function(){return W.find(function(e){return e.uuid===re})||null},[W,re]),st=(0,d.useCallback)(function(){it({sourceIndex:null,targetIndex:null})},[]);(0,d.useEffect)(function(){st(),tt(!1)},[st,re,le]),(0,d.useEffect)(function(){X&&ut(X)},[T,ut,X]),(0,d.useEffect)(function(){if(Ae){var e=setTimeout(function(){return Pe(null)},5e3);return function(){return clearTimeout(e)}}},[Ae]);var ct=(0,d.useCallback)((0,n.A)(o().mark(function e(){var t,r,a,n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(w){e.next=1;break}throw new Error(l("errors.missingSite"));case 1:return r="/sites/".concat(w,"/contents"),a="".concat(r,"/controlled-lists"),e.next=2,lt("\n    query ControlledListsRoot($path: String!) {\n        jcr {\n            nodeByPath(path: $path) {\n                uuid\n                path\n            }\n        }\n    }\n",{path:a});case 2:if(null!=(n=e.sent)&&null!==(t=n.jcr)&&void 0!==t&&t.nodeByPath){e.next=3;break}return e.next=3,lt('\n    mutation CreateControlledListsRoot($parentPath: String!) {\n        jcr(workspace: EDIT) {\n            addNode(\n                parentPathOrId: $parentPath\n                name: "controlled-lists"\n                primaryNodeType: "cl:listsFolder"\n            ) {\n                uuid\n            }\n        }\n    }\n',{parentPath:r});case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}},e)})),[lt,w,l]),ut=(0,d.useCallback)(function(){var e=(0,n.A)(o().mark(function e(t,r){var a,n,i,l,s;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=1;break}return e.abrupt("return");case 1:return ye(!0),De(null),e.prev=2,e.next=3,lt('\n    query ControlledLists($rootPath: String!, $language: String!) {\n        jcr {\n            nodeByPath(path: $rootPath) {\n                uuid\n                path\n                children(typesFilter: {types: ["cl:controlledList"]}) {\n                    nodes {\n                        uuid\n                        path\n                        name\n                        title: property(name: "jcr:title", language: $language) {\n                            value\n                        }\n                        description: property(name: "cl:description", language: $language) {\n                            value\n                        }\n                        children(typesFilter: {types: ["cl:controlledTerm"]}) {\n                            nodes {\n                                uuid\n                                path\n                                name\n                                termLabel: property(name: "jcr:title", language: $language) {\n                                    value\n                                }\n                                termDescription: property(name: "cl:description", language: $language) {\n                                    value\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n',{rootPath:t,language:T});case 3:n=e.sent,(i=((null==n||null===(a=n.jcr)||void 0===a||null===(a=a.nodeByPath)||void 0===a||null===(a=a.children)||void 0===a?void 0:a.nodes)||[]).map(M)).sort(function(e,t){return e.title.localeCompare(t.title,T,{sensitivity:"base"})}),Q(i),r?(ae(r),oe(!1)):le||i.some(function(e){return e.uuid===re})||ae((null===(l=i[0])||void 0===l?void 0:l.uuid)||null),e.next=5;break;case 4:e.prev=4,s=e.catch(2),De(s);case 5:return e.prev=5,ye(!1),e.finish(5);case 6:case"end":return e.stop()}},e,null,[[2,4,5,6]])}));return function(t,r){return e.apply(this,arguments)}}(),[lt,T,re,le]);(0,d.useEffect)(function(){var e=!0,t=function(){var t=(0,n.A)(o().mark(function t(){var r,a;return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(w){t.next=1;break}return De(new Error(l("errors.missingSite"))),t.abrupt("return");case 1:return t.prev=1,t.next=2,ct();case 2:if(r=t.sent,e){t.next=3;break}return t.abrupt("return");case 3:return H(r),t.next=4,ut(r);case 4:t.next=6;break;case 5:t.prev=5,a=t.catch(1),e&&De(a);case 6:case"end":return t.stop()}},t,null,[[1,5]])}));return function(){return t.apply(this,arguments)}}();return t(),function(){e=!1}},[ct,ut,w,l]),(0,d.useEffect)(function(){if(w){var e=!0,t=function(){var t=(0,n.A)(o().mark(function t(){var r,a,n,i,l,s;return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=1,lt("\n    query ControlledListLanguages($sitePath: String!) {\n        jcr {\n            nodeByPath(path: $sitePath) {\n                site {\n                    languages {\n                        displayName\n                        language\n                        activeInEdit\n                    }\n                }\n            }\n        }\n    }\n",{sitePath:"/sites/".concat(w)});case 1:n=t.sent,i=null!==(r=null==n||null===(a=n.jcr)||void 0===a||null===(a=a.nodeByPath)||void 0===a||null===(a=a.site)||void 0===a||null===(a=a.languages)||void 0===a?void 0:a.filter(function(e){return e.activeInEdit}))&&void 0!==r?r:[],e&&i.length&&(l=V(i.map(function(e){return{code:e.language,displayName:e.displayName||e.language}})),G(l),!l.find(function(e){return e.code===T})&&l[0]&&k(l[0].code)),t.next=3;break;case 2:t.prev=2,s=t.catch(0),console.warn("Failed to load site languages",s);case 3:case"end":return t.stop()}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}();return t(),function(){e=!1}}G([])},[lt,T,w]),(0,d.useEffect)(function(){de(le?F({},O):ot?{uuid:ot.uuid,path:ot.path,systemName:ot.systemName,title:ot.title,description:ot.description}:F({},O)),fe(F({},j)),Ke(!1)},[ot,le,T]);var dt=function(e,t){de(function(r){return F(F({},r),{},(0,c.A)({},e,t))})},mt=function(e,t){fe(function(r){return F(F({},r),{},(0,c.A)({},e,t))})},pt=function(e,t,r){Pe({type:e,message:l(t,r)})},gt=function(){var e=(0,n.A)(o().mark(function e(t){var r,a,n,i,s,c,u,d,m,p;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),X){e.next=1;break}return e.abrupt("return");case 1:if(r=ue.systemName.trim(),a=ue.title.trim(),n=ue.description.trim(),r&&a){e.next=2;break}return Pe({type:"error",message:l("errors.requiredFields")}),e.abrupt("return");case 2:if(!W.some(function(e){return e.uuid!==ue.uuid&&e.systemName.toLowerCase()===r.toLowerCase()})){e.next=3;break}return Pe({type:"error",message:l("errors.duplicateSystemName",{name:r})}),e.abrupt("return");case 3:if(i=[{name:"jcr:title",value:a,language:T},{name:"cl:description",value:n||"",language:T}],Ne(!0),e.prev=4,!le){e.next=7;break}return c=W.map(function(e){return e.name}),u=J(r,c,"controlled-list"),e.next=5,lt('\n    mutation CreateControlledList($parentPath: String!, $name: String!, $properties: [InputJCRProperty]!) {\n        jcr(workspace: EDIT) {\n            addNode(\n                parentPathOrId: $parentPath\n                name: $name\n                primaryNodeType: "cl:controlledList"\n                properties: $properties\n            ) {\n                uuid\n            }\n        }\n    }\n',{parentPath:X,name:u,properties:i});case 5:return d=e.sent,m=(null==d||null===(s=d.jcr)||void 0===s||null===(s=s.addNode)||void 0===s?void 0:s.uuid)||null,pt("success","feedback.listCreated"),oe(!1),e.next=6,ut(X,m);case 6:e.next=10;break;case 7:if(!ot){e.next=10;break}return e.next=8,lt("\n    mutation UpdateControlledList($path: String!, $properties: [InputJCRProperty]!) {\n        jcr(workspace: EDIT) {\n            mutateNode(pathOrId: $path) {\n                setPropertiesBatch(properties: $properties) {\n                    property {\n                        name\n                    }\n                }\n                uuid\n            }\n        }\n    }\n",{path:ot.path,properties:i});case 8:if(ot.systemName===r){e.next=9;break}return e.next=9,lt(x,{path:ot.path,name:r});case 9:return pt("success","feedback.listUpdated"),e.next=10,ut(X,ot.uuid);case 10:e.next=12;break;case 11:e.prev=11,p=e.catch(4),Pe({type:"error",message:p.message});case 12:return e.prev=12,Ne(!1),e.finish(12);case 13:case"end":return e.stop()}},e,null,[[4,11,12,13]])}));return function(t){return e.apply(this,arguments)}}(),ft=function(){var e=(0,n.A)(o().mark(function e(t){var r;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(X&&t){e.next=1;break}return e.abrupt("return");case 1:if(q(l("lists.deleteConfirm",{title:t.title}))){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=3,lt(h,{path:t.path});case 3:return pt("success","feedback.listDeleted"),e.next=4,ut(X);case 4:e.next=6;break;case 5:e.prev=5,r=e.catch(2),Pe({type:"error",message:r.message});case 6:case"end":return e.stop()}},e,null,[[2,5]])}));return function(t){return e.apply(this,arguments)}}(),vt=function(){var e=(0,n.A)(o().mark(function e(t){var r,a,n,i,s,c;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),ot){e.next=1;break}return e.abrupt("return");case 1:if(r=ge.value.trim(),a=ge.label.trim(),n=ge.description.trim(),r&&a){e.next=2;break}return Pe({type:"error",message:l("errors.requiredFields")}),e.abrupt("return");case 2:if(i=z(r)){e.next=3;break}return Pe({type:"error",message:l("errors.invalidSystemName")}),e.abrupt("return");case 3:if(!ot.terms.some(function(e){return e.uuid!==ge.uuid&&e.name.toLowerCase()===i.toLowerCase()})){e.next=4;break}return Pe({type:"error",message:l("errors.duplicateTermValue",{value:i})}),e.abrupt("return");case 4:if(s=[{name:"jcr:title",value:a,language:T},{name:"cl:description",value:n||"",language:T}],ke(!0),e.prev=5,!ge.uuid){e.next=8;break}return e.next=6,lt(y,{path:ge.path,properties:s});case 6:if(ge.value===i){e.next=7;break}return e.next=7,lt(x,{path:ge.path,name:i});case 7:pt("success","feedback.termUpdated"),e.next=10;break;case 8:return e.next=9,lt(b,{parentPath:ot.path,name:i,properties:s});case 9:pt("success","feedback.termCreated");case 10:return fe(F({},j)),e.next=11,ut(X,ot.uuid);case 11:e.next=13;break;case 12:e.prev=12,c=e.catch(5),Pe({type:"error",message:c.message});case 13:return e.prev=13,ke(!1),e.finish(13);case 14:case"end":return e.stop()}},e,null,[[5,12,13,14]])}));return function(t){return e.apply(this,arguments)}}(),ht=function(){var e=(0,n.A)(o().mark(function e(){var t,r,a,n,i,s;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ot){e.next=1;break}return e.abrupt("return");case 1:if(t=Ye.value.trim(),r=Ye.label.trim(),a=Ye.description.trim(),t&&r){e.next=2;break}return Pe({type:"error",message:l("errors.requiredFields")}),e.abrupt("return");case 2:if(n=z(t)){e.next=3;break}return Pe({type:"error",message:l("errors.invalidSystemName")}),e.abrupt("return");case 3:if(!ot.terms.some(function(e){return e.uuid!==Ye.uuid&&e.name.toLowerCase()===n.toLowerCase()})){e.next=4;break}return Pe({type:"error",message:l("errors.duplicateTermValue",{value:n})}),e.abrupt("return");case 4:return i=[{name:"jcr:title",value:r,language:T},{name:"cl:description",value:a||"",language:T}],ke(!0),e.prev=5,e.next=6,lt(y,{path:Ye.path,properties:i});case 6:if(Ye.value===n){e.next=7;break}return e.next=7,lt(x,{path:Ye.path,name:n});case 7:return pt("success","feedback.termUpdated"),Ke(!1),e.next=8,ut(X,ot.uuid);case 8:e.next=10;break;case 9:e.prev=9,s=e.catch(5),Pe({type:"error",message:s.message});case 10:return e.prev=10,ke(!1),e.finish(10);case 11:case"end":return e.stop()}},e,null,[[5,9,10,11]])}));return function(){return e.apply(this,arguments)}}(),bt=function(){var e=(0,n.A)(o().mark(function e(t){var r;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ot&&t){e.next=1;break}return e.abrupt("return");case 1:if(q(l("terms.deleteConfirm",{label:t.label||t.value}))){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,$e&&Ye.uuid===t.uuid&&Ke(!1),e.next=3,lt(h,{path:t.path});case 3:return pt("success","feedback.termDeleted"),e.next=4,ut(X,ot.uuid);case 4:e.next=6;break;case 5:e.prev=5,r=e.catch(2),Pe({type:"error",message:r.message});case 6:case"end":return e.stop()}},e,null,[[2,5]])}));return function(t){return e.apply(this,arguments)}}(),yt=function(){var e=(0,n.A)(o().mark(function e(t){var r,a,n,i,s,c,d,m,p,g,f,v,h,x=arguments;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=x.length>1&&void 0!==x[1]?x[1]:{},ot){e.next=1;break}return Pe({type:"error",message:l("import.errors.noList")}),e.abrupt("return");case 1:if(Ke(!1),Me(!0),e.prev=2,a=new Set(ot.terms.map(function(e){return e.name})),n=new Map(ot.terms.map(function(e){return[e.name.toLowerCase(),e]})),i=[],s=[],c=r.language||T,d=Boolean(r.overrideExisting),t.forEach(function(e){var t,r,l,o=null===(t=e.value)||void 0===t?void 0:t.trim(),u=null===(r=e.label)||void 0===r?void 0:r.trim();if(u){var m=z(o||"");if(m){var p=m.toLowerCase(),g=(null===(l=e.description)||void 0===l?void 0:l.trim())||"",f=[{name:"jcr:title",value:u,language:c},{name:"cl:description",value:g,language:c}],v=n.get(p);if(v)d&&s.push({path:v.path,properties:f});else if(!a.has(m)){var h=m;a.add(h),n.set(p,{path:null}),i.push({name:h,properties:f})}}}}),i.length||s.length){e.next=3;break}return Pe({type:"error",message:l("import.errors.noValidRows")}),e.abrupt("return");case 3:return e.next=4,Promise.allSettled(i.map(function(e){return lt(b,{parentPath:ot.path,name:e.name,properties:e.properties})}));case 4:return m=e.sent,e.next=5,Promise.allSettled(s.map(function(e){return lt(y,{path:e.path,properties:e.properties})}));case 5:if(p=e.sent,g=m.filter(function(e){return"fulfilled"===e.status}).length,f=p.filter(function(e){return"fulfilled"===e.status}).length,v=[].concat((0,u.A)(m),(0,u.A)(p)).find(function(e){return"rejected"===e.status}),!(g+f>0)){e.next=6;break}return ze(!1),pt("success","feedback.termImported",{count:g+f}),e.next=6,ut(X,ot.uuid);case 6:if(!v){e.next=7;break}throw v.reason;case 7:e.next=9;break;case 8:e.prev=8,h=e.catch(2),Pe({type:"error",message:h.message});case 9:return e.prev=9,Me(!1),e.finish(9);case 10:case"end":return e.stop()}},e,null,[[2,8,9,10]])}));return function(t){return e.apply(this,arguments)}}(),xt=(0,d.useCallback)(function(e){it(function(t){if(null===t.sourceIndex)return t;var r=(null==ot?void 0:ot.terms.length)||0,a=Math.max(0,Math.min(e,r));return a===t.targetIndex?t:F(F({},t),{},{targetIndex:a})})},[ot]),wt=function(){var e=(0,n.A)(o().mark(function e(t){var r,a,n,i;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==nt.sourceIndex&&null!==nt.targetIndex&&ot){e.next=1;break}return st(),e.abrupt("return");case 1:if(t.preventDefault(),t.stopPropagation(),r=nt.sourceIndex,a=nt.targetIndex,n=U(ot.terms,r,a),st(),n){e.next=2;break}return e.abrupt("return");case 2:return tt(!0),e.prev=3,e.next=4,lt("\n    mutation ReorderControlledTerms($path: String!, $names: [String]!) {\n        jcr(workspace: EDIT) {\n            mutateNode(pathOrId: $path) {\n                reorderChildren(names: $names)\n            }\n        }\n    }\n",{path:ot.path,names:n.map(function(e){return e.name})});case 4:return pt("success","feedback.termReordered"),e.next=5,ut(X,ot.uuid);case 5:e.next=7;break;case 6:e.prev=6,i=e.catch(3),Pe({type:"error",message:i.message});case 7:return e.prev=7,tt(!1),e.finish(7);case 8:case"end":return e.stop()}},e,null,[[3,6,7,8]])}));return function(t){return e.apply(this,arguments)}}(),Et=function(){et||st()},Nt=D.find(function(e){return e.code===T});return m().createElement(m().Fragment,null,m().createElement(p.LayoutContent,{header:m().createElement(p.Header,{title:"".concat(l("pageTitle")).concat(N?" - Site ".concat(N):""),subtitle:l("pageSubtitle"),mainActions:[m().createElement(p.Button,{key:"create-list",color:"accent",size:"big",label:l("actions.createList"),onClick:function(){oe(!0),ae(null),de(F({},O)),fe(F({},j)),st()}})]}),content:m().createElement("div",{className:E().layout},Ae&&m().createElement("div",{className:"".concat(E().feedback," ").concat("error"===Ae.type?E().feedbackError:E().feedbackSuccess)},Ae.message),_e&&m().createElement("div",{className:"".concat(E().feedback," ").concat(E().feedbackError)},_e.message),m().createElement("div",{className:E().container},m().createElement("div",{className:E().listPanel},m().createElement(p.Typography,{variant:"heading"},l("lists.title")),m().createElement("div",{className:E().listsContainer},0===W.length&&!be&&m().createElement(p.Typography,{variant:"body"},l("lists.empty")),W.map(function(e){return m().createElement("button",{key:e.uuid,type:"button",className:"".concat(E().listButton," ").concat(e.uuid!==re||le?"":E().listButtonActive),onClick:function(){ae(e.uuid),oe(!1)}},m().createElement("span",null,e.title))})),m().createElement(p.Button,{size:"big",label:l("actions.reload"),onClick:function(){return ut(X)}})),m().createElement("div",{className:E().contentPanel},be&&m().createElement(p.Typography,{variant:"body"},l("states.loading")),!be&&(W.length>0||le)&&m().createElement(m().Fragment,null,D.length?m().createElement("div",{className:E().languageTabs},D.map(function(e){return m().createElement("button",{key:e.code,type:"button",className:"".concat(E().languageTab," ").concat(e.code===T?E().languageTabActive:""),onClick:function(){var t;(t=e.code)&&t!==T&&k(t)}},m().createElement("span",{className:E().languageFlag},R(e.code)),m().createElement("span",null,e.displayName||e.code))})):null,m().createElement(p.Paper,{className:E().card},m().createElement(p.Typography,{variant:"heading"},l(le?"lists.createTitle":"lists.editTitle")),m().createElement("form",{onSubmit:gt},m().createElement("div",{className:E().formGroup},m().createElement(p.Typography,{variant:"body",weight:"bold"},l("lists.fields.systemName")),m().createElement(p.Input,{value:ue.systemName,onChange:function(e){return dt("systemName",e.target.value)}}),m().createElement(p.Typography,{variant:"caption"},l("lists.help.systemName"))),m().createElement("div",{className:E().formGroup},m().createElement(p.Typography,{variant:"body",weight:"bold"},l("lists.fields.title")),m().createElement(p.Input,{value:ue.title,onChange:function(e){return dt("title",e.target.value)}})),m().createElement("div",{className:E().formGroup},m().createElement(p.Typography,{variant:"body",weight:"bold"},l("lists.fields.description")),m().createElement("textarea",{className:E().textarea,value:ue.description,onChange:function(e){return dt("description",e.target.value)}})),m().createElement("div",{style:{display:"flex",gap:"12px"}},m().createElement(p.Button,{type:"submit",size:"big",disabled:Ee,label:l("actions.save")}),!le&&m().createElement(p.Button,{type:"button",size:"big",color:"danger",label:l("actions.delete"),onClick:function(){return ft(ot)}})))),!ot||le?null:m().createElement(p.Paper,{className:E().card},m().createElement("div",{className:E().cardHeader},m().createElement(p.Typography,{variant:"heading"},l("terms.title")),m().createElement(p.Button,{size:"big",color:"accent",isDisabled:Ue,label:l("actions.importTerms"),onClick:function(){return ze(!0)}})),m().createElement("div",{style:{overflowX:"auto",marginTop:"12px"}},m().createElement(p.Table,{className:E().termsTable},m().createElement(p.TableHead,null,m().createElement(p.TableRow,null,m().createElement(p.TableHeadCell,null,l("terms.fields.value")),m().createElement(p.TableHeadCell,null,l("terms.fields.label")),m().createElement(p.TableHeadCell,null,l("terms.fields.description")),m().createElement(p.TableHeadCell,null,l("actions.actionsColumn")))),m().createElement(p.TableBody,{onDrop:wt},function(){if(!ot||0===ot.terms.length)return m().createElement(p.TableRow,null,m().createElement(p.TableBodyCell,{colSpan:4},l("terms.empty")));var e=ot.terms.length>1&&!et,t=null!==nt.sourceIndex&&null!==nt.targetIndex&&(nt.targetIndex===nt.sourceIndex||nt.targetIndex===nt.sourceIndex+1&&nt.targetIndex>nt.sourceIndex),r=null===nt.sourceIndex||null===nt.targetIndex||t?null:nt.targetIndex,a=function(e){return m().createElement(p.TableRow,{key:"placeholder-".concat(e),className:E().placeholderRow},m().createElement(p.TableBodyCell,{colSpan:4},m().createElement("div",{className:E().placeholderBar})))},n=[];return ot.terms.forEach(function(t,i){r===i&&n.push(a("before-".concat(t.uuid)));var o=[E().termRow];nt.sourceIndex===i&&o.push(E().draggingRow),e||o.push(E().termRowDragDisabled),n.push(m().createElement(p.TableRow,{key:t.uuid,className:o.join(" "),draggable:e,onDragStart:function(e){return function(e,t){!ot||ot.terms.length<2||et||(e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",ot.terms[t].uuid)),it({sourceIndex:t,targetIndex:t}))}(e,i)},onDragOver:function(e){return function(e,t){if(null!==nt.sourceIndex){e.preventDefault();var r=e.currentTarget.getBoundingClientRect(),a=e.clientY-r.top>r.height/2;xt(a?t+1:t)}}(e,i)},onDragEnd:Et},m().createElement(p.TableBodyCell,null,t.value),m().createElement(p.TableBodyCell,null,t.label),m().createElement(p.TableBodyCell,{className:E().descriptionCell},m().createElement("div",{className:E().descriptionContent},t.description)),m().createElement(p.TableBodyCell,null,m().createElement("div",{className:E().termActions},m().createElement(p.Button,{size:"small",label:l("actions.edit"),onClick:function(){return function(e){Ke(!0),Ze({uuid:e.uuid,path:e.path,value:e.value,label:e.label,description:e.description||""})}(t)}}),m().createElement(p.Button,{size:"small",color:"danger",label:l("actions.delete"),onClick:function(){return bt(t)}})))))}),null!==r&&r===ot.terms.length&&n.push(a("after-last")),e&&n.push(m().createElement(p.TableRow,{key:"drop-zone",className:E().dropZoneRow,onDragOver:function(e){null!==nt.sourceIndex&&(e.preventDefault(),xt(ot.terms.length))}},m().createElement(p.TableBodyCell,{colSpan:4}))),n}()))),m().createElement("form",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},onSubmit:vt},m().createElement(p.Typography,{variant:"subheading"},ge.uuid?l("terms.editTitle"):l("terms.addTitle")),m().createElement("div",{className:E().formGroup},m().createElement(p.Typography,{variant:"body",weight:"bold"},l("terms.fields.value")),m().createElement(p.Input,{value:ge.value,onChange:function(e){return mt("value",e.target.value)}})),m().createElement("div",{className:E().formGroup},m().createElement(p.Typography,{variant:"body",weight:"bold"},l("terms.fields.label")),m().createElement(p.Input,{value:ge.label,onChange:function(e){return mt("label",e.target.value)}})),m().createElement("div",{className:E().formGroup},m().createElement(p.Typography,{variant:"body",weight:"bold"},l("terms.fields.description")),m().createElement("textarea",{className:E().textarea,value:ge.description,onChange:function(e){return mt("description",e.target.value)}})),m().createElement("div",{style:{display:"flex",gap:"12px"}},m().createElement(p.Button,{type:"submit",size:"big",disabled:Te,label:l("actions.save")}),m().createElement(p.Button,{type:"button",size:"big",label:l("actions.cancel"),onClick:function(){return fe(F({},j))}}))))),!be&&0===W.length&&!le&&m().createElement(p.Paper,{className:E().card},m().createElement(p.Typography,{variant:"body"},l("lists.empty"))))))}),m().createElement(P,{isOpen:je,t:l,siteLanguages:D,initialLanguage:T,onClose:function(){return ze(!1)},onImport:yt}),m().createElement(_,{isOpen:$e,form:Ye,isSaving:Te,t:l,languageCode:T,languageName:null==Nt?void 0:Nt.displayName,onChange:function(e,t){Ze(function(r){return F(F({},r),{},(0,c.A)({},e,t))})},onClose:function(){return Ke(!1)},onSave:ht}))},$=function(e){var t=e.width,r=void 0===t?12:t,a=e.height,n=void 0===a?12:a;return m().createElement("svg",{width:r,height:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},m().createElement("path",{d:"M4.5 6.5l1.8 1.8 3.2-3.3 1.1 1.1-4.3 4.4-2.9-2.9 1.1-1.1z"}),m().createElement("rect",{x:"12",y:"6",width:"8",height:"2",rx:"1"}),m().createElement("path",{d:"M4.5 12.5l1.8 1.8 3.2-3.3 1.1 1.1-4.3 4.4-2.9-2.9 1.1-1.1z"}),m().createElement("rect",{x:"12",y:"12",width:"8",height:"2",rx:"1"}),m().createElement("path",{d:"M4.5 18.5l1.8 1.8 3.2-3.3 1.1 1.1-4.3 4.4-2.9-2.9 1.1-1.1z"}),m().createElement("rect",{x:"12",y:"18",width:"8",height:"2",rx:"1"}))},K=function(e){var t=e.width,r=void 0===t?12:t,a=e.height,n=void 0===a?12:a;return m().createElement("svg",{width:r,height:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},m().createElement("path",{d:"M10 3h4v4h-4V3zM4 13h4v4H4v-4zm12 0h4v4h-4v-4zM12 7v3h-6v3m6-6v3h6v3"}))},X=function(){window.jahia.i18n.loadNamespaces("controlled-lists"),a.registry.add("accordionItem","taxonomyAccordion",a.registry.get("accordionItem","renderDefaultApps"),{targets:["jcontent:75"],icon:m().createElement(K,{width:24,height:24}),label:"controlled-lists:accordionTitle",appsTarget:"taxonomyAccordionApps"}),a.registry.add("adminRoute","controlled-lists",{targets:["taxonomyAccordionApps"],icon:m().createElement($,null),label:"controlled-lists:label",path:"".concat(s,"*"),defaultPath:s,isSelectable:!0,requireModuleInstalledOnSite:"controlled-lists",render:function(e){return m().createElement(d.Suspense,{fallback:"loading ..."},m().createElement(G,{match:e.match}))}})};$.propTypes={width:C().number,height:C().number},K.propTypes={width:C().number,height:C().number};var H=r(1793),Y=r.n(H);const Z=JSON.parse('{"controlled-lists":{"label":"Controlled lists","pageTitle":"Controlled lists","pageSubtitle":"Store centrally managed key/value lists for editors and developers.","states":{"loading":"Loading controlled lists..."},"errors":{"missingSite":"Please select a site to use controlled lists.","requiredFields":"System name and title are mandatory.","duplicateSystemName":"A list already uses the system name \\"{{name}}\\".","duplicateTermValue":"A term already uses the system name \\"{{value}}\\".","invalidSystemName":"Please provide a valid system name (letters, numbers, hyphens)."},"actions":{"createList":"New list","reload":"Reload","save":"Save","cancel":"Cancel","delete":"Delete","edit":"Edit","actionsColumn":"Actions","importTerms":"Import terms"},"lists":{"title":"Lists","empty":"No controlled lists yet.","createTitle":"Create a new list","editTitle":"Edit list","fields":{"systemName":"System name","title":"Title","description":"Description"},"help":{"systemName":"Unique identifier used by developers and APIs."},"deleteConfirm":"Delete the list \\"{{title}}\\"?"},"terms":{"title":"Terms","empty":"No terms defined for this list.","addTitle":"Add a term","editTitle":"Edit term","fields":{"value":"System name","label":"Label (title)","description":"Description"},"deleteConfirm":"Delete the term \\"{{label}}\\"?"},"feedback":{"listCreated":"List created successfully.","listUpdated":"List updated.","listDeleted":"List deleted.","termCreated":"Term created.","termUpdated":"Term updated.","termDeleted":"Term deleted.","termImported":"{{count}} term(s) imported.","termReordered":"Term order updated."},"edit":{"title":"Edit term"},"import":{"title":"Import terms","instructions":"Upload a CSV (columns: systemName,label,description) or a JSON array with those properties.","selectFile":"Choose CSV or JSON file","supportedFormats":"Supported formats: CSV, JSON","parsing":"Parsing file...","preview":"Preview ({{count}} rows)","moreRows":"and {{count}} more...","importButton":"Import","language":"Language","override":"Overwrite existing translations","errors":{"invalidFormat":"The file format is invalid. Ensure it contains systemName, label, and description fields.","readFailed":"Unable to read file.","noValidRows":"No valid rows were found to import.","noList":"Please select a list before importing terms.","noLanguage":"Please select a language."}},"accordionTitle":"Taxonomy Tools"}}'),W=JSON.parse('{"controlled-lists":{"label":"Listes contrÃ´lÃ©es","pageTitle":"Listes contrÃ´lÃ©es","pageSubtitle":"GÃ©rez des listes clÃ©/valeur rÃ©utilisables dans toute la plateforme.","states":{"loading":"Chargement des listes contrÃ´lÃ©es..."},"errors":{"missingSite":"Merci de sÃ©lectionner un site pour utiliser les listes contrÃ´lÃ©es.","requiredFields":"Le nom systÃ¨me et le titre sont obligatoires.","duplicateSystemName":"Une liste utilise dÃ©jÃ  le nom systÃ¨me \\"{{name}}\\".","duplicateTermValue":"Un terme utilise dÃ©jÃ  le nom systÃ¨me \\"{{value}}\\".","invalidSystemName":"Merci de fournir un nom systÃ¨me valide (lettres, chiffres, tirets)."},"actions":{"createList":"Nouvelle liste","reload":"RafraÃ®chir","save":"Enregistrer","cancel":"Annuler","delete":"Supprimer","edit":"Modifier","actionsColumn":"Actions","importTerms":"Importer des termes"},"lists":{"title":"Listes","empty":"Aucune liste contrÃ´lÃ©e pour l\'instant.","createTitle":"CrÃ©er une nouvelle liste","editTitle":"Modifier la liste","fields":{"systemName":"Nom systÃ¨me","title":"Titre","description":"Description"},"help":{"systemName":"Identifiant unique utilisÃ© par les dÃ©veloppeurs et les API."},"deleteConfirm":"Supprimer la liste \\"{{title}}\\" ?"},"terms":{"title":"Termes","empty":"Aucun terme n\'est dÃ©fini pour cette liste.","addTitle":"Ajouter un terme","editTitle":"Modifier le terme","fields":{"value":"Nom systÃ¨me","label":"LibellÃ© (titre)","description":"Description"},"deleteConfirm":"Supprimer le terme \\"{{label}}\\" ?"},"feedback":{"listCreated":"Liste crÃ©Ã©e.","listUpdated":"Liste mise Ã  jour.","listDeleted":"Liste supprimÃ©e.","termCreated":"Terme crÃ©Ã©.","termUpdated":"Terme mis Ã  jour.","termDeleted":"Terme supprimÃ©.","termImported":"{{count}} terme(s) importÃ©(s).","termReordered":"Ordre des termes mis Ã  jour."},"edit":{"title":"Modifier le terme"},"import":{"title":"Importer des termes","instructions":"TÃ©lÃ©chargez un fichier CSV (colonnes : systemName,label,description) ou un JSON contenant ces propriÃ©tÃ©s.","selectFile":"Choisir un fichier CSV ou JSON","supportedFormats":"Formats pris en charge : CSV, JSON","parsing":"Analyse du fichier...","preview":"AperÃ§u ({{count}} lignes)","moreRows":"et {{count}} de plus...","importButton":"Importer","language":"Langue","override":"Ã‰craser les traductions existantes","errors":{"invalidFormat":"Format de fichier invalide. Assurez-vous que les champs systemName, label et description sont prÃ©sents.","readFailed":"Impossible de lire le fichier.","noValidRows":"Aucune ligne valide Ã  importer.","noList":"SÃ©lectionnez une liste avant d\'importer des termes.","noLanguage":"Merci de sÃ©lectionner une langue."}},"accordionTitle":"Outils de taxonomie"}}'),Q=JSON.parse('{"controlled-lists":{"label":"Listen verwalten","pageTitle":"Kontrollierte Listen","pageSubtitle":"Pflegen Sie zentral gesteuerte SchlÃ¼ssel/Wert-Listen fÃ¼r Redakteure und Entwickler.","states":{"loading":"Kontrollierte Listen werden geladen..."},"errors":{"missingSite":"Bitte wÃ¤hlen Sie eine Seite aus, um kontrollierte Listen zu verwenden.","requiredFields":"Systemname und Titel sind Pflichtfelder.","duplicateSystemName":"Eine Liste verwendet bereits den Systemnamen \\"{{name}}\\".","duplicateTermValue":"Ein Begriff verwendet bereits den Systemnamen \\"{{value}}\\".","invalidSystemName":"Bitte einen gÃ¼ltigen Systemnamen angeben (Buchstaben, Zahlen, Bindestriche)."},"actions":{"createList":"Neue Liste","reload":"Aktualisieren","save":"Speichern","cancel":"Abbrechen","delete":"LÃ¶schen","edit":"Bearbeiten","actionsColumn":"Aktionen","importTerms":"Begriffe importieren"},"lists":{"title":"Listen","empty":"Noch keine kontrollierten Listen vorhanden.","createTitle":"Neue Liste anlegen","editTitle":"Liste bearbeiten","fields":{"systemName":"Systemname","title":"Titel","description":"Beschreibung"},"help":{"systemName":"Eindeutiger Bezeichner fÃ¼r Entwickler und APIs."},"deleteConfirm":"Liste \\"{{title}}\\" lÃ¶schen?"},"terms":{"title":"Begriffe","empty":"FÃ¼r diese Liste sind keine Begriffe definiert.","addTitle":"Begriff hinzufÃ¼gen","editTitle":"Begriff bearbeiten","fields":{"value":"Systemname","label":"Bezeichnung (Titel)","description":"Beschreibung"},"deleteConfirm":"Begriff \\"{{label}}\\" lÃ¶schen?"},"feedback":{"listCreated":"Liste wurde erstellt.","listUpdated":"Liste wurde aktualisiert.","listDeleted":"Liste wurde gelÃ¶scht.","termCreated":"Begriff wurde erstellt.","termUpdated":"Begriff wurde aktualisiert.","termDeleted":"Begriff wurde gelÃ¶scht.","termImported":"{{count}} Begriff(e) importiert.","termReordered":"Reihenfolge der Begriffe aktualisiert."},"edit":{"title":"Begriff bearbeiten"},"import":{"title":"Begriffe importieren","instructions":"CSV (Spalten: systemName,label,description) oder eine JSON-Liste mit diesen Feldern hochladen.","selectFile":"CSV oder JSON wÃ¤hlen","supportedFormats":"UnterstÃ¼tzte Formate: CSV, JSON","parsing":"Datei wird analysiert ...","preview":"Vorschau ({{count}} Zeilen)","moreRows":"und {{count}} weitere...","importButton":"Importieren","language":"Sprache","override":"Bestehende Ãœbersetzungen Ã¼berschreiben","errors":{"invalidFormat":"UngÃ¼ltiges Dateiformat. Stellen Sie sicher, dass systemName, label und description enthalten sind.","readFailed":"Datei konnte nicht gelesen werden.","noValidRows":"Keine gÃ¼ltigen Zeilen zum Import gefunden.","noList":"Bitte wÃ¤hlen Sie vor dem Import eine Liste aus.","noLanguage":"Bitte wÃ¤hlen Sie eine Sprache."}},"accordionTitle":"Taxonomie-Tools"}}'),ee=JSON.parse('{"controlled-lists":{"label":"Listas controladas","pageTitle":"Listas controladas","pageSubtitle":"Administra listas clave/valor reutilizables para editores y desarrolladores.","states":{"loading":"Cargando listas controladas..."},"errors":{"missingSite":"Selecciona un sitio para usar las listas controladas.","requiredFields":"El nombre del sistema y el tÃ­tulo son obligatorios.","duplicateSystemName":"Ya existe una lista con el nombre de sistema \\"{{name}}\\".","duplicateTermValue":"Ya existe un tÃ©rmino con el nombre de sistema \\"{{value}}\\".","invalidSystemName":"Ingresa un nombre de sistema vÃ¡lido (letras, nÃºmeros, guiones)."},"actions":{"createList":"Nueva lista","reload":"Recargar","save":"Guardar","cancel":"Cancelar","delete":"Eliminar","edit":"Editar","actionsColumn":"Acciones","importTerms":"Importar tÃ©rminos"},"lists":{"title":"Listas","empty":"No hay listas controladas todavÃ­a.","createTitle":"Crear una nueva lista","editTitle":"Editar lista","fields":{"systemName":"Nombre del sistema","title":"TÃ­tulo","description":"DescripciÃ³n"},"help":{"systemName":"Identificador Ãºnico usado por desarrolladores y APIs."},"deleteConfirm":"Â¿Eliminar la lista \\"{{title}}\\"?"},"terms":{"title":"TÃ©rminos","empty":"No hay tÃ©rminos definidos para esta lista.","addTitle":"Agregar tÃ©rmino","editTitle":"Editar tÃ©rmino","fields":{"value":"Nombre del sistema","label":"Etiqueta (tÃ­tulo)","description":"DescripciÃ³n"},"deleteConfirm":"Â¿Eliminar el tÃ©rmino \\"{{label}}\\"?"},"feedback":{"listCreated":"Lista creada correctamente.","listUpdated":"Lista actualizada.","listDeleted":"Lista eliminada.","termCreated":"TÃ©rmino creado.","termUpdated":"TÃ©rmino actualizado.","termDeleted":"TÃ©rmino eliminado.","termImported":"{{count}} tÃ©rmino(s) importado(s).","termReordered":"Orden de tÃ©rminos actualizado."},"edit":{"title":"Editar tÃ©rmino"},"import":{"title":"Importar tÃ©rminos","instructions":"Carga un CSV (columnas: systemName, label, description) o un JSON con esas propiedades.","selectFile":"Elegir archivo CSV o JSON","supportedFormats":"Formatos admitidos: CSV, JSON","parsing":"Analizando archivo...","preview":"PrevisualizaciÃ³n ({{count}} filas)","moreRows":"y {{count}} mÃ¡s...","importButton":"Importar","language":"Idioma","override":"Sobrescribir traducciones existentes","errors":{"invalidFormat":"El formato del archivo es invÃ¡lido. AsegÃºrate de que incluya systemName, label y description.","readFailed":"No se pudo leer el archivo.","noValidRows":"No se encontraron filas vÃ¡lidas para importar.","noList":"Selecciona una lista antes de importar.","noLanguage":"Selecciona un idioma."}},"accordionTitle":"Herramientas de taxonomÃ­a"}}'),te=JSON.parse('{"controlled-lists":{"label":"Listas controladas","pageTitle":"Listas controladas","pageSubtitle":"Mantenha listas chave/valor reutilizÃ¡veis para editores e desenvolvedores.","states":{"loading":"Carregando listas controladas..."},"errors":{"missingSite":"Selecione um site para usar as listas controladas.","requiredFields":"Nome do sistema e tÃ­tulo sÃ£o obrigatÃ³rios.","duplicateSystemName":"JÃ¡ existe uma lista com o nome \\"{{name}}\\".","duplicateTermValue":"JÃ¡ existe um termo com o nome de sistema \\"{{value}}\\".","invalidSystemName":"Informe um nome de sistema vÃ¡lido (letras, nÃºmeros, hÃ­fens)."},"actions":{"createList":"Nova lista","reload":"Recarregar","save":"Salvar","cancel":"Cancelar","delete":"Excluir","edit":"Editar","actionsColumn":"AÃ§Ãµes","importTerms":"Importar termos"},"lists":{"title":"Listas","empty":"Ainda nÃ£o hÃ¡ listas controladas.","createTitle":"Criar nova lista","editTitle":"Editar lista","fields":{"systemName":"Nome do sistema","title":"TÃ­tulo","description":"DescriÃ§Ã£o"},"help":{"systemName":"Identificador Ãºnico usado por desenvolvedores e APIs."},"deleteConfirm":"Excluir a lista \\"{{title}}\\"?"},"terms":{"title":"Termos","empty":"Nenhum termo definido para esta lista.","addTitle":"Adicionar termo","editTitle":"Editar termo","fields":{"value":"Nome do sistema","label":"RÃ³tulo (tÃ­tulo)","description":"DescriÃ§Ã£o"},"deleteConfirm":"Excluir o termo \\"{{label}}\\"?"},"feedback":{"listCreated":"Lista criada.","listUpdated":"Lista atualizada.","listDeleted":"Lista excluÃ­da.","termCreated":"Termo criado.","termUpdated":"Termo atualizado.","termDeleted":"Termo excluÃ­do.","termImported":"{{count}} termo(s) importado(s).","termReordered":"Ordem dos termos atualizada."},"edit":{"title":"Editar termo"},"import":{"title":"Importar termos","instructions":"Envie um CSV (colunas: systemName,label,description) ou um JSON com essas propriedades.","selectFile":"Escolher arquivo CSV ou JSON","supportedFormats":"Formatos suportados: CSV, JSON","parsing":"Analisando arquivo...","preview":"PrÃ©via ({{count}} linhas)","moreRows":"e mais {{count}}...","importButton":"Importar","language":"Idioma","override":"Substituir traduÃ§Ãµes existentes","errors":{"invalidFormat":"Formato de arquivo invÃ¡lido. Certifique-se de que contenha systemName, label e description.","readFailed":"NÃ£o foi possÃ­vel ler o arquivo.","noValidRows":"Nenhuma linha vÃ¡lida encontrada.","noList":"Selecione uma lista antes de importar.","noLanguage":"Selecione um idioma."}},"accordionTitle":"Ferramentas de taxonomia"}}'),re=JSON.parse('{"controlled-lists":{"label":"Liste controllate","pageTitle":"Liste controllate","pageSubtitle":"Gestisci liste chiave/valore centralizzate per editor e sviluppatori.","states":{"loading":"Caricamento delle liste controllate..."},"errors":{"missingSite":"Seleziona un sito per usare le liste controllate.","requiredFields":"Nome di sistema e titolo sono obbligatori.","duplicateSystemName":"Esiste giÃ  una lista con il nome di sistema \\"{{name}}\\".","duplicateTermValue":"Esiste giÃ  un termine con il nome di sistema \\"{{value}}\\".","invalidSystemName":"Inserisci un nome di sistema valido (lettere, numeri, trattini)."},"actions":{"createList":"Nuova lista","reload":"Ricarica","save":"Salva","cancel":"Annulla","delete":"Elimina","edit":"Modifica","actionsColumn":"Azioni","importTerms":"Importa termini"},"lists":{"title":"Liste","empty":"Nessuna lista controllata disponibile.","createTitle":"Crea nuova lista","editTitle":"Modifica lista","fields":{"systemName":"Nome di sistema","title":"Titolo","description":"Descrizione"},"help":{"systemName":"Identificatore univoco usato da sviluppatori e API."},"deleteConfirm":"Eliminare la lista \\"{{title}}\\"?"},"terms":{"title":"Termini","empty":"Nessun termine definito per questa lista.","addTitle":"Aggiungi termine","editTitle":"Modifica termine","fields":{"value":"Nome di sistema","label":"Etichetta (titolo)","description":"Descrizione"},"deleteConfirm":"Eliminare il termine \\"{{label}}\\"?"},"feedback":{"listCreated":"Lista creata.","listUpdated":"Lista aggiornata.","listDeleted":"Lista eliminata.","termCreated":"Termine creato.","termUpdated":"Termine aggiornato.","termDeleted":"Termine eliminato.","termImported":"{{count}} termine/i importati.","termReordered":"Ordine dei termini aggiornato."},"edit":{"title":"Modifica termine"},"import":{"title":"Importa termini","instructions":"Carica un CSV (colonne: systemName, label, description) o un JSON con le stesse proprietÃ .","selectFile":"Scegli file CSV o JSON","supportedFormats":"Formati supportati: CSV, JSON","parsing":"Analisi del file in corso...","preview":"Anteprima ({{count}} righe)","moreRows":"e altre {{count}}...","importButton":"Importa","language":"Lingua","override":"Sovrascrivi traduzioni esistenti","errors":{"invalidFormat":"Formato file non valido. Assicurati di includere systemName, label e description.","readFailed":"Impossibile leggere il file.","noValidRows":"Nessuna riga valida trovata.","noList":"Seleziona una lista prima di importare.","noLanguage":"Seleziona una lingua."}},"accordionTitle":"Strumenti di tassonomia"}}');var ae=function(e){var t,r=e.value,a=e.onChange,l=e.language,s=window.contextJsParameters||{},c=s.siteKey||(null===(t=s.site)||void 0===t?void 0:t.key)||"",g=l||s.lang||s.language||s.uilang||"en",v=(0,d.useState)(c?"/sites/".concat(c,"/contents/controlled-lists"):null),h=(0,i.A)(v,1)[0],b=(0,d.useState)([]),y=(0,i.A)(b,2),x=y[0],w=y[1],N=(0,d.useState)(!1),C=(0,i.A)(N,2),S=C[0],T=C[1],k=(0,d.useState)(null),L=(0,i.A)(k,2),I=L[0],A=L[1],P=(0,d.useMemo)(function(){return function(e){if(!e)return{listId:null,terms:[]};try{var t=JSON.parse(e);return{listId:t.listId||null,terms:Array.isArray(t.terms)?t.terms:[]}}catch(e){return{listId:null,terms:[]}}}(r)},[r]),B=x.find(function(e){return e.uuid===P.listId})||null,_=(0,d.useMemo)(function(){return new Set(P.terms.map(function(e){return e.uuid}))},[P.terms]);(0,d.useEffect)(function(){if(h){var e=function(){var e=(0,n.A)(o().mark(function e(){var t,r,a,n,i,l;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return T(!0),A(null),e.prev=1,e.next=2,f().post("".concat(s.contextPath||"","/modules/graphql"),{query:'\n    query SelectorControlledLists($rootPath: String!, $language: String!) {\n        jcr {\n            nodeByPath(path: $rootPath) {\n                children(typesFilter: {types: ["cl:controlledList"]}) {\n                    nodes {\n                        uuid\n                        name\n                        title: property(name: "jcr:title", language: $language) {\n                            value\n                        }\n                        children(typesFilter: {types: ["cl:controlledTerm"]}) {\n                            nodes {\n                                uuid\n                                name\n                                termLabel: property(name: "jcr:title", language: $language) {\n                                    value\n                                }\n                                termDescription: property(name: "cl:description", language: $language) {\n                                    value\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n',variables:{rootPath:h,language:g}},{headers:{"Content-Type":"application/json"},withCredentials:!0});case 2:if(a=e.sent,null===(t=a.data)||void 0===t||null===(t=t.errors)||void 0===t||!t.length){e.next=3;break}throw new Error(a.data.errors.map(function(e){return e.message}).join("\n"));case 3:n=(null===(r=a.data)||void 0===r||null===(r=r.data)||void 0===r||null===(r=r.jcr)||void 0===r||null===(r=r.nodeByPath)||void 0===r||null===(r=r.children)||void 0===r?void 0:r.nodes)||[],(i=n.map(function(e){var t,r;return{uuid:e.uuid,name:e.name,label:(null===(t=e.title)||void 0===t?void 0:t.value)||e.name,terms:((null===(r=e.children)||void 0===r?void 0:r.nodes)||[]).map(function(e){var t,r;return{uuid:e.uuid,value:e.name,label:(null===(t=e.termLabel)||void 0===t?void 0:t.value)||e.name,description:(null===(r=e.termDescription)||void 0===r?void 0:r.value)||""}})}})).sort(function(e,t){return e.label.localeCompare(t.label)}),w(i),e.next=5;break;case 4:e.prev=4,l=e.catch(1),A(l);case 5:return e.prev=5,T(!1),e.finish(5);case 6:case"end":return e.stop()}},e,null,[[1,4,5,6]])}));return function(){return e.apply(this,arguments)}}();e()}},[s.contextPath,g,h,c]);if(!h)return m().createElement(p.Typography,{variant:"body"},s.siteKey?"Missing lists root.":"Please select a site.");if(S)return m().createElement("div",{className:E().selectorLoading},m().createElement(p.Loader,{size:"big"}),m().createElement(p.Typography,{variant:"body"},"Loading controlled lists..."));if(I)return m().createElement(p.Typography,{variant:"body",color:"danger"},I.message);var D=x.map(function(e){return{label:e.label,value:e.uuid}});return m().createElement(p.Paper,{className:E().selectorCard},m().createElement("div",{className:E().selectorContainer},m().createElement("div",{className:E().formGroup},m().createElement(p.Typography,{variant:"body",weight:"bold"},"Controlled list"),m().createElement(p.Dropdown,{data:D,value:(null==B?void 0:B.uuid)||null,placeholder:"Select a controlled list",onChange:function(e,t){var r=t.value;a(r?JSON.stringify({listId:r,terms:[]}):"")}})),B&&m().createElement("div",{className:E().selectorTerms},m().createElement(p.Typography,{variant:"body",weight:"bold"},"Terms ",g&&"(".concat(R(g)," ").concat(g.toUpperCase(),")")),m().createElement("div",{className:E().selectorTermsList},B.terms.map(function(e){return m().createElement(p.CheckboxItem,{key:e.uuid,label:e.label,description:e.description||e.value,checked:_.has(e.uuid),onChange:function(){return function(e){var t;t=_.has(e.uuid)?P.terms.filter(function(t){return t.uuid!==e.uuid}):[].concat((0,u.A)(P.terms),[e]),a(JSON.stringify({listId:(null==B?void 0:B.uuid)||null,terms:t}))}(e)}})})),P.terms.length>0&&m().createElement("div",{className:E().selectorSelection},m().createElement(p.Typography,{variant:"body",weight:"bold"},"Selected"),m().createElement("div",{className:E().selectorChips},P.terms.map(function(e){return m().createElement(p.Chip,{key:e.uuid,label:e.label})})),m().createElement(p.Button,{size:"small",label:"Clear selection",onClick:function(){return a(JSON.stringify({listId:B.uuid,terms:[]}))}})))))};ae.propTypes={value:C().string,onChange:C().func.isRequired,language:C().string},ae.defaultProps={value:"",language:null};var ne=function(){[["en",Z],["fr",W],["de",Q],["es",ee],["pt",te],["it",re]].forEach(function(e){var t=(0,i.A)(e,2),r=t[0],a=t[1]["controlled-lists"];a&&!Y().hasResourceBundle(r,"controlled-lists")&&Y().addResourceBundle(r,"controlled-lists",a,!0,!0)})};function ie(){return le.apply(this,arguments)}function le(){return(le=(0,n.A)(o().mark(function e(){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return ne(),e.next=1,Y().loadNamespaces("controlled-lists");case 1:a.registry.add("selectorType","controlledListsSelector",{cmp:ae,supportMultiple:!1}),X();case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function oe(){a.registry.add("callback","controlled-lists",{targets:["jahiaApp-init:2"],callback:ie})}},9838:()=>{}}]);
//# sourceMappingURL=137.jahia.aaa855.js.map